<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAD Builder V18 - Ready ğŸš€</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest" defer></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Aref+Ruqaa:wght@400;700&family=Cairo:wght@200..1000&family=Rakkas&family=Tajawal:wght@200..900&display=swap');
        [x-cloak] { display: none !important; }
        body { font-family: 'Cairo', sans-serif; background: #f3f4f6; color: #111; height: 100vh; overflow: hidden; }
        .app-layout { display: flex; height: 100vh; flex-direction: row-reverse; }
        .editor-sidebar { width: 450px; background: #fff; border-left: 1px solid #e5e7eb; overflow-y: auto; padding: 20px; z-index: 10; flex-shrink: 0; }
        .preview-area { flex: 1; background: #cbd5e1; display: flex; flex-direction: column; align-items: center; overflow-y: auto; padding: 40px 0; position: relative; }
        .iphone-wrapper { transition: transform 0.2s ease; transform-origin: top center; margin-bottom: 50px; }
        .iphone { width: 375px; height: 800px; background: #000; border-radius: 40px; border: 12px solid #1a1a1a; overflow: hidden; position: relative; box-shadow: 0 30px 60px rgba(0,0,0,0.4); background-color: #fff; }
        .iphone iframe { width: 100%; height: 100%; border: none; background: #fff; }
        .section-box { background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 12px; padding: 15px; margin-bottom: 15px; }
        label { font-size: 11px; font-weight: 700; display: block; margin-bottom: 4px; color: #4b5563; }
        input, textarea, select { width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px; margin-bottom: 8px; outline: none; }
        .btn-add { background: #fff; border: 1px solid #ddd; padding: 8px; border-radius: 6px; font-size: 11px; font-weight: bold; cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 4px; }
        .btn-add:hover { background: #f3f4f6; border-color: #000; }
        .btn-download { background: #000; color: #fff; width: 100%; padding: 15px; border-radius: 10px; font-weight: 800; margin-top: 10px; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 8px; }
        .btn-copy { background: #4b5563; color: #fff; width: 100%; padding: 15px; border-radius: 10px; font-weight: 800; margin-top: 10px; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 8px; transition: 0.2s; }
        .btn-copy:hover { background: #374151; }
        .sub-item { border-top: 1px dashed #eee; padding-top: 8px; margin-top: 8px; }
        .zoom-controls { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); padding: 8px 16px; border-radius: 99px; display: flex; gap: 10px; color: white; z-index: 50; align-items: center; }
        .zoom-btn { cursor: pointer; padding: 4px; } .zoom-btn:hover { color: #ddd; }
    </style>
</head>
<body>

<div class="app-layout" x-data="builderApp()" x-init="init()" x-cloak>
    <aside class="editor-sidebar">
        <h1 class="text-xl font-black mb-6 text-center">MAD BUILDER <span class="text-emerald-600">V18</span></h1>
        
        <div class="flex bg-gray-100 p-1 rounded-lg mb-4">
            <button @click="setEditLang('ar')" :class="editLang==='ar'?'bg-black text-white':''" class="flex-1 py-2 rounded-md text-xs font-bold transition">Ø¹Ø±Ø¨ÙŠ</button>
            <button @click="setEditLang('he')" :class="editLang==='he'?'bg-black text-white':''" class="flex-1 py-2 rounded-md text-xs font-bold transition">×¢×‘×¨×™×ª</button>
        </div>

        <div class="section-box border-green-200 bg-green-50/50">
            <h2 class="font-bold text-xs mb-2 text-green-700">ğŸ’° Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø³Ø¹Ø±</h2>
            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ (Ù„Ù„Ø´ÙŠØª)</label>
            <input type="text" x-model="config.productName" class="font-bold" @input="updatePreviewDebounced()" placeholder="Ø¹Ø·Ø± Ø§Ù„Ø¹ÙŠØ¯">
            <label>Ø§Ù„Ø³Ø¹Ø± (Ø´ÙŠÙƒÙ„)</label>
            <input type="number" x-model="config.price" class="font-bold text-center" @input="updatePreviewDebounced()" placeholder="150">
        </div>

        <div class="section-box border-blue-200 bg-blue-50/50">
            <h2 class="font-bold text-xs mb-2 text-blue-700">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ø¨Ø· ÙˆØ§Ù„Ù…Ø¯ÙŠØ±</h2>
            <label>Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙƒØ±Ø¨Øª (ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« âœ…)</label>
            <input type="text" x-model="config.sheetUrl" class="text-xs font-mono mb-2 bg-white">
            
            <label class="text-indigo-700 font-black">ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯ÙŠØ± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <input type="text" x-model="config.adminPhone" class="text-center font-bold border-indigo-300 bg-indigo-50" placeholder="972500000000">
            
            <div class="grid grid-cols-3 gap-1 mt-2">
                <div><label>FB Pixel</label><input type="text" x-model="config.fbPixel"></div>
                <div><label>TikTok</label><input type="text" x-model="config.ttPixel"></div>
                <div><label>Snap</label><input type="text" x-model="config.snapPixel"></div>
            </div>
        </div>

        <div class="section-box">
            <h2 class="font-bold text-xs mb-2">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø©</h2>
            <div class="space-y-2 mb-4">
                <template x-for="(block, index) in blocks" :key="block.id">
                    <div class="bg-white border p-3 rounded-lg relative shadow-sm">
                        <button @click="removeBlock(index)" class="absolute top-2 left-2 text-red-500 font-bold hover:bg-red-50 rounded px-1">Ã—</button>
                        <div class="flex justify-between mb-2 pl-6">
                            <span class="text-[10px] bg-gray-100 px-2 rounded uppercase font-bold text-gray-400" x-text="block.type"></span>
                            <div class="flex gap-1">
                                <button @click="moveBlock(index, -1)" class="p-1">â†‘</button>
                                <button @click="moveBlock(index, 1)" class="p-1">â†“</button>
                            </div>
                        </div>
                        
                        <template x-if="block.type === 'text'">
                            <div class="space-y-2">
                                <div class="flex flex-wrap gap-2 items-center bg-gray-50 p-2 rounded border border-gray-200">
                                    <input type="color" x-model="block.style.color" @input="updatePreviewDebounced()" class="w-8 h-8 p-0 border-0 rounded cursor-pointer">
                                    <select x-model="block.style.font" @change="updatePreviewDebounced()" class="text-[10px] p-1 border rounded h-8 bg-white"><option value="Cairo">Cairo</option><option value="Tajawal">Tajawal</option><option value="Amiri">Amiri</option></select>
                                    <select x-model="block.style.size" @change="updatePreviewDebounced()" class="text-[10px] p-1 border rounded h-8 bg-white"><option value="text-sm">S</option><option value="text-base">M</option><option value="text-lg">L</option><option value="text-xl">XL</option><option value="text-2xl">2XL</option></select>
                                    <button @click="block.style.weight = (block.style.weight === 'font-normal' ? 'font-black' : 'font-normal'); updatePreviewDebounced()" class="p-1 border rounded bg-white w-8 h-8 font-black">B</button>
                                    <select x-model="block.align" @change="updatePreviewDebounced()" class="text-[10px] p-1 border rounded h-8 bg-white w-16"><option value="center">ÙˆØ³Ø·</option><option value="right">ÙŠÙ…ÙŠÙ†</option><option value="left">ÙŠØ³Ø§Ø±</option></select>
                                </div>
                                <textarea x-model="block.content[editLang]" @input="updatePreviewDebounced()" class="mt-2 h-20 w-full border p-2 rounded text-xs"></textarea>
                            </div>
                        </template>

                        <template x-if="['button','emoji','fragrantica'].includes(block.type)">
                            <textarea x-model="block.content[editLang]" @input="updatePreviewDebounced()" class="mt-2 h-14 w-full border p-1 rounded text-xs"></textarea>
                        </template>
                        
                        <template x-if="['image','video','iframe','fragrantica'].includes(block.type)">
                            <input type="text" x-model="block.url" @input="updatePreviewDebounced()" placeholder="URL" class="mt-2 w-full border p-1 rounded text-xs">
                        </template>

                        <template x-if="block.type === 'form'">
                            <div>
                                <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙˆØ±Ù…</label>
                                <input type="text" x-model="block.content[editLang]" @input="updatePreviewDebounced()" class="mt-1 w-full border p-1 rounded text-xs">
                                <label class="mt-2 text-pink-600">Ù†Øµ Ø²Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯</label>
                                <input type="text" x-model="block.btnText[editLang]" @input="updatePreviewDebounced()" class="mt-1 w-full border border-pink-200 p-1 rounded text-xs font-bold text-center" placeholder="Ù…Ø«Ø§Ù„: ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†">
                            </div>
                        </template>

                        <template x-if="block.type === 'embed'">
                            <div>
                                <label class="text-blue-600">ÙƒÙˆØ¯ Ø§Ù„ØªØ¶Ù…ÙŠÙ† (HTML / Iframe / Script)</label>
                                <textarea x-model="block.content[editLang]" @input="updatePreviewDebounced()" class="mt-2 h-24 w-full border p-2 rounded text-xs font-mono text-left bg-gray-50" dir="ltr" placeholder="<iframe...></iframe> or <script>...</script>"></textarea>
                            </div>
                        </template>

                        <template x-if="block.type === 'comparison'">
                            <div class="mt-2 space-y-2">
                                <template x-for="(item, iIdx) in block.items" :key="iIdx">
                                    <div class="sub-item">
                                        <input type="text" x-model="item.mad[editLang]" @input="updatePreviewDebounced()" placeholder="MAD" class="w-full text-[10px] mb-1">
                                        <input type="text" x-model="item.other[editLang]" @input="updatePreviewDebounced()" placeholder="Others" class="w-full text-[10px]">
                                    </div>
                                </template>
                                <button @click="block.items.push({mad:{ar:'', he:''}, other:{ar:'', he:''}}); updatePreviewDebounced()" class="text-[10px] text-blue-600 font-bold">+ Ø¥Ø¶Ø§ÙØ© Ø³Ø·Ø±</button>
                            </div>
                        </template>
                    </div>
                </template>
            </div>
            
            <div class="section-box">
                <h2 class="font-bold text-xs mb-2">ğŸ¨ Ø§Ù„Ù…Ø¸Ù‡Ø±</h2>
                <label>Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ©</label><input type="color" x-model="config.bgColor" @input="updatePreviewDebounced()">
                <label>Ø±Ø§Ø¨Ø· Ø§Ù„Ø´Ø¹Ø§Ø±</label><input type="text" x-model="config.logoUrl" @input="updatePreviewDebounced()">
                <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</label><input type="text" x-model="config.heroTitle[editLang]" @input="updatePreviewDebounced()">
            </div>

            <div class="grid grid-cols-3 gap-2">
                <button class="btn-add" @click="addBlock('text')">ğŸ“ Ù†Øµ</button>
                <button class="btn-add" @click="addBlock('image')">ğŸ–¼ï¸ ØµÙˆØ±Ø©</button>
                <button class="btn-add" @click="addBlock('video')">ğŸ¥ ÙÙŠØ¯ÙŠÙˆ</button>
                <button class="btn-add" @click="addBlock('form')">ğŸ“‹ ÙÙˆØ±Ù…</button>
                <button class="btn-add" @click="addBlock('iso')">ğŸ›¡ï¸ ISO</button>
                <button class="btn-add" @click="addBlock('comparison')">âš–ï¸ Ù…Ù‚Ø§Ø±Ù†Ø©</button>
                <button class="btn-add" @click="addBlock('fragrantica')">â­ ØªÙ‚ÙŠÙŠÙ…</button>
                <button class="btn-add" @click="addBlock('button')">ğŸ”— Ø²Ø±</button>
                <button class="btn-add border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100" @click="addBlock('embed')">ğŸ’» ÙƒÙˆØ¯</button>
            </div>
        </div>

        <button class="btn-download" @click="downloadHTML()">ğŸ’¾ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©</button>
        <button class="btn-copy" @click="copyCode()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>
    </aside>

    <main class="preview-area">
        <div class="zoom-controls">
            <button @click="zoomOut()" class="zoom-btn"><i data-lucide="minus" class="w-4"></i></button>
            <span class="text-xs font-bold w-8 text-center" x-text="Math.round(zoom*100) + '%'"></span>
            <button @click="zoomIn()" class="zoom-btn"><i data-lucide="plus" class="w-4"></i></button>
            <button @click="updatePreview()" class="zoom-btn border-r border-white/20 pr-2 mr-2"><i data-lucide="refresh-cw" class="w-4"></i></button>
        </div>
        <div class="iphone-wrapper" :style="`transform: scale(${zoom})`">
            <div class="iphone"><iframe id="preview-frame"></iframe></div>
        </div>
    </main>
</div>

<script>
    function builderApp() {
        return {
            editLang: 'ar',
            zoom: 0.85,
            previewTimeout: null,
            config: {
                bgColor: '#f7e8e8',
                logoUrl: 'https://madperfume.ps/upload/01-2026/page/6977cf82b87ef.png',
                heroTitle: {ar: 'Ø£Ù‚ÙˆÙ‰ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø­ØµØ±ÙŠØ©', he: '×”××‘×¦×¢×™× ×”×‘×œ×¢×“×™×™× ×‘×™×•×ª×¨'},
                productName: 'MAD Offer',
                price: '150',
                adminPhone: '972525105889',
                // âœ… ØªÙ… ÙˆØ¶Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù‡Ù†Ø§
                sheetUrl: 'https://script.google.com/macros/s/AKfycbw7m6OCcTnH6CILpTo2TVRZIXXy5cui-zhKsCq3k491yaun5Hd5b_QECTjCrpCytkndDg/exec',
                fbPixel: '1072283127290819', ttPixel: 'D2D02JBC77U4ENLN9SBG', snapPixel: 'b143822e-1c3c-40ff-93f7-edadee74e626'
            },
            blocks: [
                {id:1, type:'text', content:{ar:'Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ', he:'×‘×¨×•×›×™× ×”×‘××™×'}, align:'center', style:{color:'#000000', size:'text-lg', font:'Cairo', weight:'font-black'}},
                {id:2, type:'form', content:{ar:'Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†', he:'×”×–×× ×” ××”×™×¨×”'}, btnText:{ar:'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨', he:'×©×œ×— ×”×–×× ×”'}, align:'center'}
            ],
            
            init() { setTimeout(()=> { if(window.lucide) lucide.createIcons(); this.updatePreview(); }, 500); if(window.innerHeight < 900) this.zoom = 0.7; },
            setEditLang(l) { this.editLang = l; this.updatePreview(); },
            updatePreviewDebounced() { clearTimeout(this.previewTimeout); this.previewTimeout = setTimeout(()=> this.updatePreview(), 400); },
            zoomIn() { if(this.zoom < 1.2) this.zoom += 0.05; },
            zoomOut() { if(this.zoom > 0.4) this.zoom -= 0.05; },

            addBlock(type) {
                let items = [];
                let content = {ar:'', he:''};
                let style = {}; 
                let btnText = {ar:'', he:''};

                if(type === 'text') style = { color: '#000000', size: 'text-lg', font: 'Cairo', weight: 'font-black' };
                if(type === 'comparison') items = [{mad:{ar:'',he:''}, other:{ar:'',he:''}}];
                if(type === 'form') {
                    content = {ar:'Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†', he:'×”×–×× ×” ××”×™×¨×”'};
                    btnText = {ar:'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨', he:'×©×œ×— ×”×–×× ×”'};
                }
                this.blocks.push({id:Date.now(), type, content, btnText, url:'', link:'#order', align:'center', items, score:'4.9 / 5', style});
                this.updatePreview();
            },
            removeBlock(i) { this.blocks.splice(i,1); this.updatePreview(); },
            moveBlock(i, d) {
                const ni = i + d;
                if (ni < 0 || ni >= this.blocks.length) return;
                [this.blocks[i], this.blocks[ni]] = [this.blocks[ni], this.blocks[i]];
                this.updatePreview();
            },
            updatePreview() {
                const frame = document.getElementById('preview-frame');
                if(frame) frame.srcdoc = this.generateFinalHTML(false);
            },
            async copyCode() {
                const code = this.generateFinalHTML(true);
                try { await navigator.clipboard.writeText(code); alert('âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø®!'); } 
                catch(err) { const ta = document.createElement('textarea'); ta.value = code; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta); alert('âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø®!'); }
            },
            generateFinalHTML(isDownload) {
                const bJ = JSON.stringify(this.blocks).replace(/</g, '\\u003c');
                const cJ = JSON.stringify(this.config).replace(/</g, '\\u003c');
                const PRICE_VAL = this.config.price || '0';
                const PROD_NAME = (this.config.productName || 'MAD Offer').replace(/'/g, "\\'");
                const ADMIN_PHONE_VAL = this.config.adminPhone || '';
                const iL = isDownload ? null : `'${this.editLang}'`;

                return `<!DOCTYPE html>
<html x-data="app()" x-init="init(${iL})" :lang="lang" :dir="lang==='he'?'ltr':'rtl'">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"><\/script>
<script src="https://unpkg.com/lucide@latest" defer><\/script>
<script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer><\/script>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Aref+Ruqaa:wght@400;700&family=Cairo:wght@200..1000&family=Rakkas&family=Tajawal:wght@200..900&display=swap" rel="stylesheet">
<script>
window.addEventListener('DOMContentLoaded', () => {
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)n=f.fbq;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '${this.config.fbPixel}'); fbq('track', 'PageView');
});
<\/script>
<style>
body { background: ${this.config.bgColor}; font-family: 'Cairo', sans-serif; overflow-x: hidden; }
.inp { width: 100%; padding: 15px; background: #f8fafc; border: 1px solid #ddd; border-radius: 12px; margin-bottom: 10px; font-weight: bold; }
.btn-main { background: #000; color: #fff; width: 100%; padding: 18px; border-radius: 14px; font-weight: 900; font-size: 1.2rem; }
.page-block { content-visibility: auto; contain-intrinsic-size: 0 400px; }
</style>
</head>
<body class="pb-20">
    <nav class="p-4 flex justify-center bg-white/40 backdrop-blur sticky top-0 z-50"><img src="${this.config.logoUrl}" class="h-10 object-contain"></nav>
    <header class="text-center py-8 px-4"><h1 class="text-3xl font-black" x-text="c.heroTitle[lang]"></h1></header>
    
    <main class="max-w-md mx-auto px-4">
        <template x-for="(b, idx) in blocks">
            <div class="my-6 page-block" :class="b.align==='center'?'text-center':(b.align==='left'?'text-left':'text-right')">
                <template x-if="b.type==='text'">
                    <p class="whitespace-pre-wrap leading-relaxed" 
                       :class="[b.style?.size || 'text-lg', b.style?.weight || 'font-bold']"
                       :style="{ color: b.style?.color || '#000', fontFamily: (b.style?.font || 'Cairo') + ', sans-serif' }"
                       x-text="b.content[lang]"></p>
                </template>
                <template x-if="b.type==='emoji'"><div class="text-4xl" x-text="b.content[lang]"></div></template>
                <template x-if="b.type==='image'"><img :src="b.url" class="rounded-2xl mx-auto shadow-lg w-full" :loading="idx===0?'eager':'lazy'"></template>
                <template x-if="b.type==='video'"><video :src="b.url" controls class="w-full rounded-2xl shadow-lg" playsinline preload="none"></video></template>
                <template x-if="b.type==='iframe'"><iframe :src="b.url" class="w-full h-96 rounded-xl border-none shadow-sm" loading="lazy"></iframe></template>
                <template x-if="b.type==='button'"><a :href="b.link" class="btn-main block text-center no-underline" x-text="b.content[lang]"></a></template>
                <template x-if="b.type==='embed'"><div x-html="b.content[lang]"></div></template>
                <template x-if="b.type==='iso'">
                    <div class="grid grid-cols-3 gap-3 w-full max-w-sm mx-auto mt-4">
                        <div class="bg-white border border-black/5 p-3 rounded-2xl text-center shadow-sm"><div class="text-xl">ğŸ›¡ï¸</div><p class="text-[8px] font-black uppercase leading-tight">ISO 9001<br>Certified</p></div>
                        <div class="bg-white border border-black/5 p-3 rounded-2xl text-center shadow-sm"><div class="text-xl">ğŸ§ª</div><p class="text-[8px] font-black uppercase leading-tight">IFRA Safe<br>Standard</p></div>
                        <div class="bg-white border border-black/5 p-3 rounded-2xl text-center shadow-sm"><div class="text-xl">ğŸ›ï¸</div><p class="text-[8px] font-black uppercase leading-tight">Health<br>Ministry OK</p></div>
                    </div>
                </template>
                <template x-if="b.type==='comparison'">
                    <div class="space-y-2 mt-4 text-right">
                        <template x-for="row in b.items">
                            <div class="grid grid-cols-2 gap-1 rounded-xl overflow-hidden border border-black/5 shadow-sm">
                                <div class="bg-gray-50 p-4 border-r border-black/5"><span class="text-[8px] font-black text-amber-600 block mb-1">MAD</span><p class="text-[11px] font-bold leading-tight" x-text="row.mad[lang]"></p></div>
                                <div class="bg-white p-4 text-gray-400 text-right"><span class="text-[8px] font-black text-gray-300 block mb-1">OTHERS</span><p class="text-[11px]" x-text="row.other[lang]"></p></div>
                            </div>
                        </template>
                    </div>
                </template>
                <template x-if="b.type==='fragrantica'">
                    <a :href="b.url" target="_blank" class="block w-full max-w-[320px] bg-[#3f5a31] text-white p-5 rounded-[24px] shadow-xl relative overflow-hidden mx-auto no-underline text-right">
                        <div class="flex justify-between items-center mb-3"><span class="text-[10px] font-black uppercase tracking-widest text-white/60">Fragrantica Reviews</span><div class="flex text-amber-400 gap-0.5"><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i><i data-lucide="star" class="w-3 h-3 fill-current"></i></div></div>
                        <div class="flex items-end gap-2"><span class="text-4xl font-black" x-text="b.score"></span><span class="text-xs opacity-60 mb-1">Rating</span></div>
                        <p class="text-[10px] font-bold mt-2 text-white/80" x-text="b.content[lang]"></p>
                    </a>
                </template>
                <template x-if="b.type==='form'">
                    <div class="bg-white p-6 rounded-[24px] shadow-sm text-right border-2 border-gray-100" id="order">
                        <h2 class="text-xl font-black text-center mb-4" x-text="b.content[lang] || (lang==='he'?'×”×–×× ×”':'Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†')"></h2>
                        <form @submit.prevent="submitForm">
                            <input type="text" x-model="f.name" class="inp" :placeholder="lang==='he'?'×©× ××œ×':'Ø§Ù„Ø§Ø³Ù…'" required>
                            <input type="tel" x-model="f.phone" class="inp" :placeholder="lang==='he'?'×˜×œ×¤×•×Ÿ':'Ø§Ù„Ù‡Ø§ØªÙ'" required>
                            <input type="text" x-model="f.address" class="inp" :placeholder="lang==='he'?'×›×ª×•×‘×ª':'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†'" required>
                            <div class="grid grid-cols-2 gap-2 mb-4">
                                <label class="cursor-pointer bg-gray-50 p-3 rounded-xl text-center border font-bold hover:bg-gray-100 transition ring-inset hover:ring-2 ring-black">
                                    <input type="radio" x-model="f.payment" value="Cash" class="hidden"><span x-text="lang==='he'?'××–×•××Ÿ':'Ù†Ù‚Ø¯'"></span>
                                </label>
                                <label class="cursor-pointer bg-gray-50 p-3 rounded-xl text-center border font-bold hover:bg-gray-100 transition ring-inset hover:ring-2 ring-black">
                                    <input type="radio" x-model="f.payment" value="Visa" class="hidden"><span x-text="lang==='he'?'××©×¨××™':'ÙÙŠØ²Ø§'"></span>
                                </label>
                            </div>
                            <div class="grid grid-cols-2 gap-2 mb-4">
                                <label class="cursor-pointer bg-blue-50 p-3 rounded-xl text-center border border-blue-200 font-bold hover:bg-blue-100 transition relative">
                                    <input type="radio" x-model="f.process" value="Direct" class="hidden"><span class="text-[10px]" x-text="lang==='he'?'×©×œ×— ×”×–×× ×”':'Ø§Ø±Ø³Ù„ Ø§Ù„Ø·Ù„Ø¨'"></span><div x-show="f.process==='Direct'" class="absolute top-1 right-1 text-blue-600">âœ“</div>
                                </label>
                                <label class="cursor-pointer bg-blue-50 p-3 rounded-xl text-center border border-blue-200 font-bold hover:bg-blue-100 transition relative">
                                    <input type="radio" x-model="f.process" value="Contact" class="hidden"><span class="text-[10px]" x-text="lang==='he'?'×¦×•×¨ ×§×©×¨':'ØªÙˆØ§ØµÙ„ Ù…Ø¹ÙŠ'"></span><div x-show="f.process==='Contact'" class="absolute top-1 right-1 text-blue-600">âœ“</div>
                                </label>
                            </div>
                            <button type="submit" class="btn-main" :disabled="loading" x-text="loading?'...':(b.btnText && b.btnText[lang] ? b.btnText[lang] : (lang==='he'?'×©×œ×— ×”×–×× ×”':'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨'))"></button>
                        </form>
                    </div>
                </template>
            </div>
        </template>
    </main>
    <div x-show="submitted" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center text-center text-white" style="display:none">
        <div class="bg-white text-black p-10 rounded-3xl max-w-xs"><h3 class="text-2xl font-black mb-2">âœ…</h3><p class="font-bold">ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­</p><button @click="submitted=false" class="mt-4 bg-gray-200 px-6 py-2 rounded-lg font-bold">Close</button></div>
    </div>
    <script>
        function app() {
            return {
                lang: 'ar', loading: false, submitted: false,
                blocks: ${bJ}, c: ${cJ}, f: {name:'', phone:'', address:'', payment:'Cash', process:'Direct'},
                init(l) { this.lang = l || (navigator.language.startsWith('he')?'he':'ar'); if(window.lucide) lucide.createIcons(); },
                async submitForm() {
                    this.loading = true;
                    const fd = new FormData();
                    Object.keys(this.f).forEach(k => fd.append(k, this.f[k]));
                    fd.append('lang', this.lang);
                    fd.append('offer', '${PROD_NAME}');
                    fd.append('price', '${PRICE_VAL}');
                    fd.append('admin_phone', '${ADMIN_PHONE_VAL}');
                    
                    try {
                        if(window.fbq) fbq('track', 'Purchase', {value: ${PRICE_VAL}, currency: 'ILS'});
                        await fetch(this.c.sheetUrl, { method: 'POST', body: fd, mode: 'no-cors' });
                        this.submitted = true;
                        this.f = {name:'', phone:'', address:'', payment:'Cash', process:'Direct'};
                    } catch(e) { alert('Error'); } finally { this.loading = false; }
                }
            }
        }
    <\/script>
</body>
</html>`;
            },
            downloadHTML() {
                const link = document.createElement('a');
                link.href = URL.createObjectURL(new Blob([this.generateFinalHTML(true)], {type:'text/html'}));
                link.download = 'MAD-Landing-Page.html';
                link.click();
            }
        }
    }
</script>
</body>
</html>
