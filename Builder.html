<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MAD Builder V53 - 6x6 Ultimate Guard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest" defer></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@200..1000&display=swap');
    [x-cloak]{display:none!important}
    body{font-family:'Cairo', sans-serif; background:#e2e8f0; height:100vh; overflow:hidden}
    .app-layout{display:flex; height:100vh; flex-direction:row-reverse}
    .editor-sidebar{width:400px; background:#fff; border-left:1px solid #cbd5e1; overflow-y:auto; padding:15px; flex-shrink:0}
    .preview-area{flex:1; background:#f1f5f9; display:flex; justify-content:center; align-items:center; position:relative}
    .iphone{width:375px; height:750px; background:#000; border-radius:40px; border:12px solid #2d2d2d; overflow:hidden; position:relative; background-color:#fff}
    .iphone iframe{width:100%; height:100%; border:none}
    .section-box{background:#f8fafc; border:1px solid #e2e8f0; border-radius:8px; padding:10px; margin-bottom:10px}
    .btn-grid{display:grid; grid-template-columns:repeat(3, 1fr); gap:5px}
    .btn-add{background:#fff; border:1px solid #cbd5e1; padding:8px; border-radius:6px; font-size:10px; font-weight:bold; cursor:pointer}
    .btn-action{width:100%; padding:10px; border-radius:8px; font-weight:800; margin-top:5px; cursor:pointer; text-align:center}
  </style>
</head>
<body>

<div class="app-layout" x-data="builderApp()" x-init="init()" x-cloak>
  <aside class="editor-sidebar">
    <h1 class="text-xl font-black mb-4 text-center">MAD BUILDER <span class="text-blue-600">V53.1</span></h1>

    <div class="section-box border-green-200">
      <input type="text" x-model="config.productName" @input="update()" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ (VSA)">
      <input type="number" x-model="config.price" @input="update()" placeholder="Ø§Ù„Ø³Ø¹Ø±" class="mt-2">
    </div>

    <div class="section-box border-blue-200">
      <input type="text" x-model="config.sheetUrl" placeholder="Script URL" class="mb-2" @input="update()">
      <input type="text" x-model="config.adminPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯ÙŠØ± 972" class="text-center font-bold" @input="update()">
    </div>

    <div class="section-box bg-slate-50">
      <span class="block text-[10px] font-bold mb-1 uppercase">Pixels</span>
      <input type="text" x-model="config.ttPixel" placeholder="TikTok Pixel ID" class="mb-1" @input="update()">
      <input type="text" x-model="config.fbPixel" placeholder="FB Pixel ID" @input="update()">
    </div>

    <div class="section-box">
      <span class="block text-[10px] font-bold mb-2">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰</span>
      <div class="space-y-2 mb-4">
        <template x-for="(block, index) in blocks" :key="block.id">
          <div class="bg-white border p-2 rounded relative">
            <button @click="removeBlock(index)" class="absolute top-1 left-1 text-red-500 font-bold">Ã—</button>
            <span class="text-[8px] font-black text-gray-400 uppercase" x-text="block.type"></span>
            
            <template x-if="block.type === 'comparison'"><p class="text-[10px] text-amber-600 font-bold mt-1">6 Ù…Ù‚Ø§Ø±Ù†Ø§Øª Ø¬Ø§Ù‡Ø²Ø© âœ…</p></template>
            <template x-if="block.type === 'faq'"><p class="text-[10px] text-purple-600 font-bold mt-1">6 Ø£Ø³Ø¦Ù„Ø© Ø¬Ø§Ù‡Ø²Ø© âœ…</p></template>
            <template x-if="block.type === 'text'"><textarea x-model="block.content[editLang]" @input="update()" class="h-10 text-[10px] mt-1"></textarea></template>
            <template x-if="block.type === 'image'"><input type="text" x-model="block.url" @input="update()" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©" class="text-[10px] mt-1"></template>
          </div>
        </template>
      </div>

      <div class="btn-grid">
        <button class="btn-add border-amber-500" @click="addBlock('comparison')">âš–ï¸ +6 Ù…Ù‚Ø§Ø±Ù†Ø§Øª</button>
        <button class="btn-add border-purple-500" @click="addBlock('faq')">â“ +6 Ø£Ø³Ø¦Ù„Ø©</button>
        <button class="btn-add" @click="addBlock('text')">ğŸ“ Ù†Øµ</button>
        <button class="btn-add" @click="addBlock('image')">ğŸ–¼ï¸ ØµÙˆØ±Ø©</button>
        <button class="btn-add" @click="addBlock('form')">ğŸ“‹ ÙÙˆØ±Ù…</button>
        <button class="btn-add" @click="addBlock('urgency_box')">ğŸ”¥ Ø§Ø³ØªØ¹Ø¬Ø§Ù„</button>
      </div>
    </div>

    <button class="btn-action bg-black text-white" @click="downloadHTML()">ğŸ’¾ ØªØ­Ù…ÙŠÙ„ (Download)</button>
    <button class="btn-action bg-gray-600 text-white" @click="copyCode()">ğŸ“‹ Ù†Ø³Ø® (Copy)</button>
  </aside>

  <main class="preview-area">
    <div class="iphone"><iframe id="preview-frame"></iframe></div>
  </main>
</div>

<script>
function builderApp() {
  return {
    editLang: 'ar',
    config: {
      bgColor: '#96701d',
      logoUrl: 'https://madperfume.ps/upload/01-2026/page/6977cf82b87ef.png',
      heroTitle: { ar: 'Ø¹Ø±ÙˆØ¶ Ø­ØµØ±ÙŠØ© Ù…Ù† MAD', he: '××‘×¦×¢×™× ×‘×œ×¢×“×™×™×' },
      productName: 'Exotic Oud', price: '400', adminPhone: '972525105889', sheetUrl: '',
      fbPixel: '', ttPixel: '', snapPixel: ''
    },
    blocks: [],
    init() { 
      this.addBlock('text');
      this.addBlock('comparison');
      this.addBlock('faq');
      this.addBlock('form');
      setTimeout(() => this.update(), 500); 
    },
    update() {
      const frame = document.getElementById('preview-frame');
      if (frame) frame.srcdoc = this.generateFinalHTML();
    },
    addBlock(type) {
      let b = { id: Date.now(), type, content:{ar:'Ù†Øµ Ø¬Ø¯ÙŠØ¯', he:'×˜×§×¡×˜ ×—×“×©'}, url:'', align:'center', style:{color:'#000', size:'text-base'} };
      
      if(type==='comparison') {
        b.items = [
          { mad: {ar:'Ù…Ù†ØªØ¬Ø§Øª Ø£ØµÙ„ÙŠØ© ÙˆÙ…ÙˆØ«ÙˆÙ‚Ø©',he:'××•×¦×¨×™× ××§×•×¨×™×™×'}, other: {ar:'Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¬Ù‡ÙˆÙ„Ø© Ø§Ù„Ù…ØµØ¯Ø±',he:'××•×¦×¨×™× ××–×•×™×¤×™×'} },
          { mad: {ar:'Ø«Ø¨Ø§Øª ÙŠØ¯ÙˆÙ… Ù„Ø£ÙƒØ«Ø± Ù…Ù† 48 Ø³Ø§Ø¹Ø©',he:'×¢××™×“ ×œ×™×•×ª×¨ ×-48 ×©×¢×•×ª'}, other: {ar:'ÙŠØ®ØªÙÙŠ Ø¨Ø¹Ø¯ Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©',he:'× ×¢×œ× ××—×¨×™ ×©×¢×”'} },
          { mad: {ar:'Ø²ÙŠÙˆØª Ø¹Ø·Ø±ÙŠØ© ÙØ±Ù†Ø³ÙŠØ© ÙØ§Ø®Ø±Ø©',he:'×©×× ×™× ×¦×¨×¤×ª×™×™× ×™×•×§×¨×ª×™×™×'}, other: {ar:'Ø²ÙŠÙˆØª Ø±Ø®ÙŠØµØ© ØªØ³Ø¨Ø¨ Ø­Ø³Ø§Ø³ÙŠØ©',he:'×©×× ×™× ×–×•×œ×™×'} },
          { mad: {ar:'ØªØºÙ„ÙŠÙ ÙØ®Ù… ÙŠÙ„ÙŠÙ‚ Ø¨Ùƒ',he:'××¨×™×–×” ×™×•×§×¨×ª×™×ª'}, other: {ar:'ØªØºÙ„ÙŠÙ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨Ø³ÙŠØ·',he:'××¨×™×–×” ×¤×©×•×˜×”'} },
          { mad: {ar:'Ø¶Ù…Ø§Ù† Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„',he:'××—×¨×™×•×ª ×”×—×œ×¤×” ×××™×ª×™×ª'}, other: {ar:'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¶Ù…Ø§Ù† Ø¨Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ¹',he:'××™×Ÿ ××—×¨×™×•×ª'} },
          { mad: {ar:'Ø£ÙØ¶Ù„ Ù‚ÙŠÙ…Ø© Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ø³Ø¹Ø±',he:'×”×ª××•×¨×” ×”×˜×•×‘×” ×œ××—×™×¨'}, other: {ar:'Ø³Ø¹Ø± Ù…Ø±ØªÙØ¹ ÙˆØ¬ÙˆØ¯Ø© Ù…ØªØ¯Ù†ÙŠØ©',he:'××—×™×¨ ×’×‘×•×” ××™×›×•×ª × ××•×›×”'} }
        ];
      }
      
      if(type==='faq') {
        b.items = [
          { q:{ar:'Ù‡Ù„ Ø§Ù„Ø¹Ø·ÙˆØ± Ø£ØµÙ„ÙŠØ©ØŸ',he:'×”×× ×”×‘×©××™× ××§×•×¨×™×™×?'}, a:{ar:'Ù†Ø¹Ù…ØŒ Ø¬Ù…ÙŠØ¹ Ø¹Ø·ÙˆØ±Ù†Ø§ Ø£ØµÙ„ÙŠØ© ÙˆØ¨Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±.',he:'×›×Ÿ, ×›×œ ×”×‘×©××™× ××§×•×¨×™×™×.'} },
          { q:{ar:'ÙƒÙ… ØªØ³ØªØºØ±Ù‚ Ù…Ø¯Ø© Ø§Ù„ØªÙˆØµÙŠÙ„ØŸ',he:'×›××” ×–××Ÿ ×”××©×œ×•×—?'}, a:{ar:'Ø§Ù„ØªÙˆØµÙŠÙ„ Ø®Ù„Ø§Ù„ 2-4 Ø£ÙŠØ§Ù… Ø¹Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚.',he:'××©×œ×•×— ×ª×•×š 2-4 ×™××™ ×¢×¡×§×™×.'} },
          { q:{ar:'Ù‡Ù„ Ø§Ù„Ø±Ø§Ø¦Ø­Ø© Ø«Ø§Ø¨ØªØ©ØŸ',he:'×”×× ×”×¨×™×— ×¢××™×“?'}, a:{ar:'Ù†Ø¹Ù…ØŒ Ø¹Ø·ÙˆØ± MAD Ù…Ø´Ù‡ÙˆØ±Ø© Ø¨Ø«Ø¨Ø§ØªÙ‡Ø§ Ø§Ù„Ù‚ÙˆÙŠ Ø¬Ø¯Ø§Ù‹.',he:'×›×Ÿ, ×‘×©××™ MAD ×™×“×•×¢×™× ×‘×¢××™×“×•×ª×.'} },
          { q:{ar:'Ù‡Ù„ ÙŠÙˆØ¬Ø¯ Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…ØŸ',he:'×™×© ×ª×©×œ×•× ×‘××–×•××Ÿ?'}, a:{ar:'Ø¨Ø§Ù„ØªØ£ÙƒÙŠØ¯ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¯ÙØ¹ ÙƒØ§Ø´ Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨.',he:'×›×Ÿ, ×ª×©×œ×•× ×‘××–×•××Ÿ ×‘×¢×ª ×”××¡×™×¨×”.'} },
          { q:{ar:'Ù…Ø§Ø°Ø§ Ù„Ùˆ Ù„Ù… ÙŠØ¹Ø¬Ø¨Ù†ÙŠ Ø§Ù„Ø¹Ø·Ø±ØŸ',he:'××” ×× ×œ× ××”×‘×ª×™?'}, a:{ar:'Ù†ÙˆÙØ± Ø³ÙŠØ§Ø³Ø© Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù…Ø±Ù†Ø© Ù„Ø¹Ù…Ù„Ø§Ø¦Ù†Ø§.',he:'××“×™× ×™×•×ª ×”×—×œ×¤×” ×’××™×©×”.'} },
          { q:{ar:'ÙƒÙŠÙ Ø£ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù…ØŸ',he:'××™×š ×™×•×¦×¨×™× ×§×©×¨?'}, a:{ar:'ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø±Ø§Ø³Ù„ØªÙ†Ø§ ÙˆØ§ØªØ³Ø§Ø¨ Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯ÙŠØ±.',he:'×‘×•×•××˜×¡××¤ ×©×œ ×”×× ×”×œ.'} }
        ];
      }

      if(type==='form') b.btnText = {ar:'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†', he:'××™×©×•×¨ ×”×–×× ×” ×¢×›×©×™×•'};
      this.blocks.push(b); this.update();
    },
    removeBlock(i) { this.blocks.splice(i, 1); this.update(); },
    moveBlock(i, d) {
      const ni = i + d;
      if (ni >= 0 && ni < this.blocks.length) { [this.blocks[i], this.blocks[ni]] = [this.blocks[ni], this.blocks[i]]; this.update(); }
    },
    generateFinalHTML() {
      const bJ = JSON.stringify(this.blocks).replace(/</g, '\\u003c');
      const cJ = JSON.stringify(this.config).replace(/</g, '\\u003c');
      const PRICE = this.config.price;
      const PROD = this.config.productName;

      return `<!DOCTYPE html>
<html x-data="app()" x-init="init()" :lang="lang" :dir="lang==='he'?'ltr':'rtl'">
<head>
<script src="https://cdn.tailwindcss.com"><\/script>
<script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer><\/script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;900&display=swap" rel="stylesheet">
<style>
  body { background: ${this.config.bgColor}; font-family: 'Cairo', sans-serif; overflow-x: hidden; }
  .btn-main { background: #000; color: #fff; width: 100%; padding: 20px; border-radius: 15px; font-weight: 900; animation: pulse 2s infinite; font-size: 1.2rem; }
  @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
  .card { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); }
  .inp { width: 100%; padding: 15px; background: #f8f9fa; border: 1px solid #ddd; border-radius: 12px; margin-bottom: 10px; font-weight: 700; text-align: center; }
</style>
<script>
function formatE164(p) {
    let d = String(p).replace(/[^0-9]/g, '');
    if(d.startsWith('05') && d.length === 10) d = '972' + d.slice(1);
    return d;
}
function loadPixels() {
    if(window._mad_fired) return; window._mad_fired = true;
    if('${this.config.ttPixel}') {
        !function(w,d,t){w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"];ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.load=function(e,n){var r="https://analytics.tiktok.com/i18n/pixel/events.js";ttq._i=ttq._i||{};ttq._i[e]=[];ttq._i[e]._u=r;ttq._t=ttq._t||{};ttq._t[e]=+new Date;ttq._o=ttq._o||{};ttq._o[e]=n||{};var o=document.createElement("script");o.type="text/javascript";o.async=!0;o.src=r+"?sdkid="+e+"&lib="+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};ttq.load('${this.config.ttPixel}');ttq.page();}(window,document,'ttq');
    }
    if('${this.config.fbPixel}') {
        !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)n=f.fbq;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');
        fbq('init','${this.config.fbPixel}'); fbq('track','PageView');
    }
}
<\/script>
</head>
<body class="pb-20">
  <nav class="p-4 flex justify-center sticky top-0 bg-white/20 backdrop-blur z-50"><img src="${this.config.logoUrl}" class="h-10 object-contain"></nav>
  
  <main class="max-w-md mx-auto px-4 mt-6">
    <template x-for="b in blocks">
      <div class="my-6">
        <template x-if="b.type==='text'"><p class="text-center text-white text-xl font-black" x-text="b.content[lang]"></p></template>
        <template x-if="b.type==='image'"><img :src="b.url" class="rounded-2xl w-full shadow-2xl"></template>
        
        <template x-if="b.type==='comparison'">
          <div class="space-y-3">
            <template x-for="row in b.items">
              <div class="grid grid-cols-2 gap-1 rounded-2xl overflow-hidden shadow-lg border border-white/10">
                <div class="bg-amber-100 p-5 text-center font-black text-amber-900 text-[12px] flex items-center justify-center" x-text="row.mad[lang]"></div>
                <div class="bg-white/90 p-5 text-center text-[12px] text-gray-500 font-bold flex items-center justify-center" x-text="row.other[lang]"></div>
              </div>
            </template>
          </div>
        </template>

        <template x-if="b.type==='faq'">
          <div class="bg-white rounded-3xl p-6 space-y-3 shadow-2xl">
            <template x-for="qa in b.items">
              <div class="border-b last:border-0 pb-3" x-data="{open:false}">
                <button @click="open=!open" class="w-full flex justify-between font-black text-sm text-right text-gray-800">
                  <span x-text="qa.q[lang]"></span><span x-text="open?'-':'+'"></span>
                </button>
                <p x-show="open" class="text-xs text-gray-600 mt-2 font-bold leading-relaxed" x-text="qa.a[lang]"></p>
              </div>
            </template>
          </div>
        </template>

        <template x-if="b.type==='form'">
          <div class="card" id="order">
            <form @submit.prevent="submit">
              <input type="text" x-model="f.name" @input="track('AddToCart')" class="inp" :placeholder="lang==='ar'?'Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„':'×©× ××œ×'" required>
              <input type="tel" x-model="f.phone" @input="track('AddToCart')" class="inp" :placeholder="lang==='ar'?'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ':'×˜×œ×¤×•×Ÿ'" dir="ltr" required>
              <button type="submit" class="btn-main mt-4" x-text="loading?'...':b.btnText[lang]"></button>
            </form>
          </div>
        </template>
      </div>
    </template>
  </main>

<script>
function app() {
  return {
    lang:'ar', blocks:${bJ}, f:{name:'',phone:''}, loading:false, fired:false,
    init() { 
      this.lang = (navigator.language.startsWith('he'))?'he':'ar';
      loadPixels();
    },
    track(ev) {
        let ph = formatE164(this.f.phone);
        if(ph.length < 12 || (this.fired && ev==='AddToCart')) return;
        if(ev==='AddToCart') this.fired = true;
        if(window.ttq) {
            ttq.identify({ phone_number: ph });
            ttq.track(ev==='AddToCart'?'AddToCart':'CompletePayment', { content_id:'${PROD}', value:${PRICE}, currency:'ILS' });
        }
        if(window.fbq) fbq('track', ev, { value: ${PRICE}, currency: 'ILS' });
    },
    async submit() {
        this.loading = true; this.track('Purchase');
        let fd = new FormData(); fd.append('name', this.f.name); fd.append('phone', this.f.phone);
        fd.append('offer', '${PROD}'); fd.append('price', '${PRICE}');
        try {
            await fetch('${this.config.sheetUrl}', { method: 'POST', body: fd, mode: 'no-cors' });
            alert(this.lang==='ar'?'ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!':'× ×©×œ×— ×‘×”×¦×œ×—×”!');
        } catch(e) { alert('Error'); } finally { this.loading = false; }
    }
  }
}
<\/script>
</body>
</html>`;
    },
    downloadHTML() {
      const blob = new Blob([this.generateFinalHTML()], { type: 'text/html' });
      const link = document.createElement('a'); link.href = URL.createObjectURL(blob);
      link.download = 'MAD_ULTIMATE_PAGE.html'; link.click();
    },
    copyCode() { navigator.clipboard.writeText(this.generateFinalHTML()); alert('ØªÙ… Ø§Ù„Ù†Ø³Ø®!'); }
  }
}
</script>
</body>
</html>
