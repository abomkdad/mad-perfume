<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>MAD Parfumeur | Luxury Fragrances</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;500;800&family=Noto+Sans+Arabic:wght@400;700;900&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Plus Jakarta Sans', 'Noto Sans Arabic', 'sans-serif'],
                    },
                    colors: {
                        premium: '#0A0A0A',
                        luxuryGold: '#C5A059',
                    }
                }
            }
        }
    </script>

    <style>
        :root { --gold: #C5A059; --dark: #0A0A0A; }
        body { background-color: #FDFCFB; color: var(--dark); -webkit-tap-highlight-color: transparent; }
        
        .glass-dark { background: rgba(10, 10, 10, 0.98); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); }
        .product-card { transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .product-card:active { transform: scale(0.95); }
        
        .gold-gradient { background: linear-gradient(135deg, #f6e27a 0%, #c5a059 50%, #f6e27a 100%); -webkit-background-clip: text; color: transparent; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        @keyframes reveal { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .animate-reveal { animation: reveal 0.6s ease-out forwards; }
    </style>
</head>

<body class="antialiased font-sans">

    <nav class="sticky top-0 z-50 glass-dark border-b border-white/10 px-4 py-3">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3">
                <img src="https://www.mad-parfumeur.com/assets/hero/logo.png" class="h-8 w-8 object-contain brightness-0 invert" alt="MAD">
                <div>
                    <p class="text-white font-black text-sm tracking-tight uppercase italic leading-none">MAD Parfumeur</p>
                    <p class="text-[8px] text-luxuryGold font-bold tracking-widest uppercase mt-1">Maison de Parfum</p>
                </div>
            </div>

            <div class="flex items-center gap-4">
                <button id="langBtn" class="text-white/70 text-[10px] font-bold hover:text-luxuryGold transition-colors border border-white/20 px-2 py-1 rounded">AR / HE</button>
                <button id="cartBtn" class="relative p-1">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
                    <span id="cartCountBadge" class="absolute -top-1 -right-1 bg-luxuryGold text-white text-[9px] w-4 h-4 flex items-center justify-center rounded-full font-bold">0</span>
                </button>
            </div>
        </div>
    </nav>

    <section class="bg-premium pt-10 pb-16 px-6 text-center">
        <div class="max-w-4xl mx-auto">
            <h1 id="t_hero_title" class="text-white text-3xl font-black mb-4 leading-tight animate-reveal">
                Ø¹Ø§Ù„Ù… Ù…Ù† <span class="gold-gradient">Ø§Ù„ÙØ®Ø§Ù…Ø©</span>
            </h1>
            
            <div class="max-w-md mx-auto bg-white/5 border border-white/10 p-1.5 rounded-xl flex items-center gap-2 animate-reveal">
                <input id="search" type="text" class="flex-1 bg-transparent text-white px-3 outline-none text-xs py-2" placeholder="Ø¨Ø­Ø«...">
                <div class="bg-luxuryGold px-4 py-2 rounded-lg text-premium font-black text-[10px] uppercase">Search</div>
            </div>
        </div>
    </section>

    <div class="max-w-7xl mx-auto -mt-6 relative z-20 px-4">
        <div id="categories" class="flex overflow-x-auto gap-2 no-scrollbar py-2">
            </div>
    </div>

    <main class="max-w-7xl mx-auto px-4 py-10">
        <div id="products" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-8">
            </div>
    </main>

    <div id="cartOverlay" class="fixed inset-0 bg-premium/80 backdrop-blur-md hidden z-[100]"></div>
    <div id="cartDrawer" class="fixed top-0 right-0 h-full w-full max-w-md bg-white z-[101] translate-x-full transition-transform duration-500 shadow-2xl flex flex-col">
        
        <div class="p-6 border-b flex items-center justify-between">
            <h3 id="t_cart_title" class="text-xl font-black uppercase">Ø­Ù‚ÙŠØ¨Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h3>
            <button id="closeCart" class="text-gray-400">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M6 18L18 6M6 6l12 12" stroke-width="2"/></svg>
            </button>
        </div>

        <div class="flex-1 overflow-y-auto p-6 space-y-6" id="cartItems"></div>

        <div class="p-6 bg-premium text-white rounded-t-[2rem]">
            <div class="space-y-4 mb-6">
                <input id="custName" class="w-full bg-white/10 border border-white/10 rounded-xl p-3 text-xs outline-none focus:border-luxuryGold" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
                <input id="custPhone" class="w-full bg-white/10 border border-white/10 rounded-xl p-3 text-xs outline-none focus:border-luxuryGold" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                <textarea id="custAddress" class="w-full bg-white/10 border border-white/10 rounded-xl p-3 text-xs outline-none focus:border-luxuryGold" rows="2" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"></textarea>
            </div>
            
            <div class="flex justify-between font-black text-lg mb-4">
                <span id="t_total_label">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span>
                <span class="text-luxuryGold">â‚ª<span id="total">0</span></span>
            </div>
            
            <button id="sendOrder" class="w-full bg-luxuryGold text-premium py-4 rounded-xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2">
                ØªØ£ÙƒÙŠØ¯ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
            </button>
        </div>
    </div>

<script>
    const WHATSAPP_API = "972524033442";
    const SHIPPING = 50;

    const CATEGORY_MAP = [
        { key: "men", label: { ar: "Ø±Ø¬Ø§Ù„ÙŠ", he: "×’×‘×¨×™×" }, match: "×’×‘×¨×™×" },
        { key: "women", label: { ar: "Ù†Ø³Ø§Ø¦ÙŠ", he: "× ×©×™×" }, match: "× ×©×™×" },
        { key: "niche", label: { ar: "Ù†ÙŠØ´", he: "× ×™×©×”" }, match: "Ù†ÙŠ×©×”" },
        { key: "offers", label: { ar: "Ø¹Ø±ÙˆØ¶", he: "××‘×¦×¢×™×" }, match: "××‘×¦×¢×™×" }
    ];

    let state = {
        lang: (navigator.language || "").includes("he") ? "he" : "ar",
        products: [],
        filtered: [],
        currentCat: "men",
        cart: new Map()
    };

    function T(ar, he) { return state.lang === "ar" ? ar : he; }

    async function init() {
        updateStrings();
        await fetchData();
        bindEvents();
    }

    async function fetchData() {
        try {
            const res = await fetch('products.rss?v=' + Date.now());
            const text = await res.text();
            const xml = new DOMParser().parseFromString(text, "application/xml");
            const items = Array.from(xml.querySelectorAll("item"));

            state.products = items.map(item => {
                const getG = (tag) => item.querySelector(tag)?.textContent || item.querySelector(`g\\:${tag}`)?.textContent || "";
                return {
                    id: getG("id").trim(),
                    title: getG("title"),
                    image: getG("image_link"),
                    type: getG("product_type"),
                    price: parseFloat(getG("price").replace(/[^\d.]/g, "")) || 0
                };
            }).filter(p => p.id);

            applyFilter();
            renderCategories();
        } catch (e) { console.error(e); }
    }

    function applyFilter() {
        const query = document.getElementById("search").value.toLowerCase();
        const matchWord = CATEGORY_MAP.find(c => c.key === state.currentCat).match;

        state.filtered = state.products.filter(p => {
            const isCat = p.type.includes(matchWord);
            const isSearch = p.title.toLowerCase().includes(query) || p.id.toLowerCase().includes(query);
            return isCat && isSearch;
        });
        renderProducts();
    }

    function renderCategories() {
        const container = document.getElementById("categories");
        container.innerHTML = CATEGORY_MAP.map(c => `
            <button onclick="switchCat('${c.key}')" 
                class="flex-1 whitespace-nowrap px-6 py-3 rounded-xl text-[10px] font-black uppercase transition-all border
                ${state.currentCat === c.key ? 'bg-premium text-white border-premium shadow-lg' : 'bg-white border-gray-100 text-gray-400'}">
                ${c.label[state.lang]}
            </button>
        `).join('');
    }

    function renderProducts() {
        const container = document.getElementById("products");
        container.innerHTML = state.filtered.map((p, i) => `
            <div class="product-card bg-white rounded-3xl p-3 border border-gray-50 flex flex-col">
                <div class="relative aspect-square mb-3 bg-gray-50 rounded-2xl p-2 overflow-hidden">
                    <img src="${p.image}" class="w-full h-full object-contain mix-blend-multiply">
                </div>
                <div class="flex-1">
                    <h3 class="font-bold text-[11px] leading-tight h-8 line-clamp-2 mb-2">${p.title}</h3>
                    <div class="flex items-center justify-between mt-auto">
                        <span class="text-sm font-black">â‚ª${p.price.toFixed(0)}</span>
                        <button onclick="addToCart('${p.id}')" class="w-8 h-8 ${state.cart.has(p.id) ? 'bg-black' : 'bg-luxuryGold'} text-white rounded-lg flex items-center justify-center transition-all">
                            ${state.cart.has(p.id) ? 'âœ“' : '+'}
                        </button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    function renderCart() {
        const container = document.getElementById("cartItems");
        document.getElementById("cartCountBadge").textContent = state.cart.size;
        
        if (state.cart.size === 0) {
            container.innerHTML = `<div class="text-center py-10 text-gray-300 text-xs font-bold uppercase">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>`;
            updateTotals(0);
            return;
        }

        let subtotal = 0;
        let html = "";
        state.cart.forEach((qty, id) => {
            const p = state.products.find(x => x.id === id);
            if (!p) return;
            subtotal += p.price * qty;
            html += `
                <div class="flex items-center gap-4 bg-gray-50 p-4 rounded-2xl">
                    <img src="${p.image}" class="w-16 h-16 object-contain mix-blend-multiply">
                    <div class="flex-1">
                        <p class="font-bold text-[10px] uppercase line-clamp-1">${p.title}</p>
                        <p class="text-luxuryGold font-black text-xs">â‚ª${p.price.toFixed(0)}</p>
                        <div class="flex items-center gap-3 mt-2">
                            <button onclick="changeQty('${id}', -1)" class="w-6 h-6 rounded-full bg-white border flex items-center justify-center">-</button>
                            <span class="text-xs font-black">${qty}</span>
                            <button onclick="changeQty('${id}', 1)" class="w-6 h-6 rounded-full bg-white border flex items-center justify-center">+</button>
                        </div>
                    </div>
                    <button onclick="changeQty('${id}', -100)" class="text-gray-300">âœ•</button>
                </div>
            `;
        });
        container.innerHTML = html;
        updateTotals(subtotal);
    }

    window.switchCat = (key) => { state.currentCat = key; applyFilter(); renderCategories(); };
    window.addToCart = (id) => { state.cart.set(id, 1); renderCart(); renderProducts(); openCart(); };
    window.changeQty = (id, delta) => {
        let q = (state.cart.get(id) || 0) + delta;
        if (q <= 0) state.cart.delete(id);
        else state.cart.set(id, q);
        renderCart(); renderProducts();
    };

    function updateTotals(sub) {
        document.getElementById("total").textContent = (sub > 0 ? sub + SHIPPING : 0).toFixed(0);
    }

    function openCart() { 
        document.getElementById("cartOverlay").classList.remove("hidden");
        document.getElementById("cartDrawer").classList.remove("translate-x-full");
    }

    function closeCart() {
        document.getElementById("cartDrawer").classList.add("translate-x-full");
        setTimeout(() => document.getElementById("cartOverlay").classList.add("hidden"), 500);
    }

    function updateStrings() {
        document.getElementById("t_hero_title").innerHTML = T("Ø¹Ø§Ù„Ù… Ù…Ù† <span class='gold-gradient'>Ø§Ù„ÙØ®Ø§Ù…Ø©</span>", "×¢×•×œ× ×©×œ <span class='gold-gradient'>×™×•×§×¨×”</span>");
        document.getElementById("t_cart_title").textContent = T("Ø­Ù‚ÙŠØ¨Ø© Ø§Ù„ØªØ³ÙˆÙ‚", "×¡×œ ×§× ×™×•×ª");
        document.getElementById("custName").placeholder = T("Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„", "×©× ××œ×");
        document.getElementById("custPhone").placeholder = T("Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ", "××¡×¤×¨ ×˜×œ×¤×•×Ÿ");
        document.getElementById("custAddress").placeholder = T("Ø§Ù„Ø¹Ù†ÙˆØ§Ù†", "×›×ª×•×‘×ª");
        document.getElementById("t_total_label").textContent = T("Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ", "×¡×”×´×›");
        document.getElementById("sendOrder").textContent = T("ØªØ£ÙƒÙŠØ¯ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨", "××™×©×•×¨ ×‘×•×•××˜×¡××¤");
    }

    function bindEvents() {
        document.getElementById("cartBtn").onclick = openCart;
        document.getElementById("closeCart").onclick = closeCart;
        document.getElementById("cartOverlay").onclick = closeCart;
        document.getElementById("search").oninput = applyFilter;
        document.getElementById("langBtn").onclick = () => {
            state.lang = state.lang === "ar" ? "he" : "ar";
            init();
        };
        document.getElementById("sendOrder").onclick = () => {
            const name = document.getElementById("custName").value;
            const phone = document.getElementById("custPhone").value;
            const addr = document.getElementById("custAddress").value;
            if (state.cart.size === 0 || !name || !phone) return alert("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©");
            
            let msg = `âœ¨ *Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ | MAD*\nğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${name}\nğŸ“ Ø§Ù„Ù‡Ø§ØªÙ: ${phone}\nğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${addr}\nâ”â”â”â”â”â”â”â”â”â”â”â”\nğŸ›’ Ø§Ù„Ø³Ù„Ø©:\n`;
            state.cart.forEach((qty, id) => {
                const p = state.products.find(x => x.id === id);
                msg += `â–ªï¸ ${p.title} (x${qty})\n`;
            });
            window.open(`https://wa.me/${WHATSAPP_API}?text=${encodeURIComponent(msg)}`, '_blank');
        };
    }

    init();
</script>
</body>
</html>
