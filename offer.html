<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>عرض خاص | MAD PARFUMEUR</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

<style>
body {
    margin: 0;
    background: #0b0b0b;
    font-family: Arial, sans-serif;
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
}

.offer-box {
    width: 100%;
    max-width: 420px;
    background: #111;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 0 40px rgba(212,175,55,0.25);
}

.offer-box img {
    width: 100%;
    display: block;
}

.offer-content {
    padding: 20px;
    text-align: center;
}

.offer-content h1 {
    margin: 0 0 10px;
    color: #d4af37;
    font-size: 22px;
}

.offer-content p {
    color: #ccc;
    font-size: 15px;
}

.whatsapp-btn {
    display: block;
    margin-top: 20px;
    padding: 15px;
    background: #25D366;
    color: #fff;
    font-size: 18px;
    font-weight: bold;
    text-decoration: none;
    border-radius: 12px;
}
</style>
</head>

<body>

<div class="offer-box">
    <img src="https://madperfume.co.il/upload/11-2025/product/691e3804ba4ee.jpg" alt="MAD Offer">

    <div class="offer-content">
        <h1 id="branch-title">عرض خاص</h1>
        <p id="branch-desc">اطلب الآن مباشرة من الفرع عبر واتساب</p>

        <a id="wa-btn" class="whatsapp-btn" href="#" target="_blank">
            اطلب الآن عبر واتساب
        </a>
    </div>
</div>

<script>
const BRANCHES_CSV = 'branches.csv';

function getParam(name) {
    return new URLSearchParams(window.location.search).get(name);
}

const branchId = getParam('branch');

Papa.parse(BRANCHES_CSV, {
    download: true,
    header: true,
    skipEmptyLines: true,
    transformHeader: h => h.trim(),
    complete: res => {
        const branch = res.data.find(b => b.ID === branchId);
        if (!branch) {
            document.getElementById('branch-title').innerText = 'الفرع غير موجود';
            return;
        }

        const lang = (navigator.language || '').startsWith('he') ? 'he' : 'ar';

        const name =
            lang === 'he'
            ? branch['اسم الفرع عبري']
            : branch['اسم الفرع عربي'];

        const phone =
            (branch['الهاتف'] || '')
            .replace(/\D/g, '')
            .replace(/^0/, '972');

        const msg =
            lang === 'he'
            ? `שלום, אני מעוניין להזמין מהסניף ${name}`
            : `مرحباً، أرغب بطلب هذا العرض من فرع ${name}`;

        document.getElementById('branch-title').innerText = `عرض فرع ${name}`;
        document.getElementById('wa-btn').href =
            `https://wa.me/${phone}?text=${encodeURIComponent(msg)}`;
    }
});
</script>

</body>
</html>
