<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#0A0A0A" />
  <meta property="og:image" content="https://www.mad-parfumeur.com/assets/hero/logo2.webp" />
  <title>MAD Parfumeur | Order</title>

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{ --gold:#C5A059; --dark:#0A0A0A; }
    body{
      background:#e9eaec;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      -webkit-tap-highlight-color: transparent;
    }
    .app{
      max-width:520px; margin:0 auto; min-height:100dvh;
      background:#FDFCFB; box-shadow:0 10px 40px rgba(0,0,0,.12);
    }
    @media (max-width:560px){ body{background:#FDFCFB;} .app{max-width:none; box-shadow:none;} }
    .glass-dark{ background: rgba(10,10,10,.98); backdrop-filter: blur(14px); }
    .card{ background:#fff; border:1px solid #f0f0f0; border-radius:22px; }
    .toast{
      position:fixed; left:50%; transform:translateX(-50%);
      bottom:calc(16px + env(safe-area-inset-bottom));
      z-index:9999; display:none;
      background:rgba(10,10,10,.92); color:#fff;
      padding:10px 14px; border-radius:16px;
      font-size:12px; font-weight:900; text-align:center;
      box-shadow:0 14px 30px rgba(0,0,0,.28);
      max-width:min(520px, calc(100vw - 24px));
    }
  </style>

  <!-- =========================
       META PIXEL (Lead)
       ========================= -->
  <script>
    const META_PIXEL_ID = "1072283127290819";

    (function(){
      try{
        if(!META_PIXEL_ID) return;
        !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
          n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
          n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
          t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window, document,'script',
          'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', META_PIXEL_ID);
        fbq('track', 'PageView');
      }catch(e){ console.warn("FB Pixel error", e); }
    })();

    function makeEventId(prefix){
      try{ if(window.crypto && crypto.randomUUID) return (prefix||"evt") + "_" + crypto.randomUUID(); }catch(e){}
      return (prefix||"evt") + "_" + (Date.now().toString(16) + Math.random().toString(16).slice(2));
    }

    function fireMetaLead(extra){
      try{
        const eventID = makeEventId("lead");
        const payload = Object.assign({ currency:"ILS" }, (extra||{}));
        fbq('track', 'Lead', payload, { eventID });
        return eventID;
      }catch(e){
        return "";
      }
    }
  </script>
</head>

<body class="antialiased">
  <div class="app">

    <!-- TOP NAV -->
    <nav class="sticky top-0 z-50 glass-dark border-b border-white/10 px-4 py-3 flex justify-between items-center"
         style="padding-top: calc(0.75rem + env(safe-area-inset-top));">
      <div class="flex items-center gap-2">
        <img src="https://www.mad-parfumeur.com/assets/hero/logo.png" class="h-8 brightness-0 invert" alt="MAD" />
        <span class="text-white font-black text-sm italic uppercase tracking-tighter">MAD Parfumeur</span>
      </div>
      <span id="langBadge" class="text-white/70 text-[11px] font-black"></span>
    </nav>

    <!-- HERO -->
    <section class="bg-[#0A0A0A] pt-8 pb-10 px-5 text-center">
      <h1 id="heroTitle" class="text-white text-3xl font-black mb-2 leading-tight"></h1>
      <p id="heroSub" class="text-white/70 text-[12px] font-bold"></p>
    </section>

    <!-- FORM -->
    <main class="px-4 -mt-6 pb-10">
      <div class="card p-4 shadow-sm">
        <h2 id="formTitle" class="text-[15px] font-black text-black mb-3"></h2>

        <form id="orderForm" class="space-y-3">

          <!-- 1) Address -->
          <div>
            <label id="lblAddress" class="block text-[12px] font-black text-gray-700 mb-1"></label>
            <input id="address" type="text"
                   class="w-full bg-gray-50 border border-gray-200 rounded-2xl px-4 py-3 text-sm font-bold outline-none focus:border-[#C5A059]"
                   autocomplete="street-address" />
          </div>

          <!-- 2) Name -->
          <div>
            <label id="lblName" class="block text-[12px] font-black text-gray-700 mb-1"></label>
            <input id="name" type="text"
                   class="w-full bg-gray-50 border border-gray-200 rounded-2xl px-4 py-3 text-sm font-bold outline-none focus:border-[#C5A059]"
                   autocomplete="name" />
          </div>

          <!-- 3) Phone Number -->
          <div>
            <label id="lblPhone" class="block text-[12px] font-black text-gray-700 mb-1"></label>
            <input id="phone" type="tel" inputmode="tel"
                   class="w-full bg-gray-50 border border-gray-200 rounded-2xl px-4 py-3 text-sm font-bold outline-none focus:border-[#C5A059]"
                   autocomplete="tel" />
          </div>

          <!-- 4) Payment Method -->
          <div>
            <label id="lblPay" class="block text-[12px] font-black text-gray-700 mb-1"></label>
            <select id="paymentMethod"
                    class="w-full bg-gray-50 border border-gray-200 rounded-2xl px-4 py-3 text-sm font-black outline-none focus:border-[#C5A059]">
              <option value="" id="optPay0"></option>
              <option value="cash" id="optPay1"></option>
              <option value="visa" id="optPay2"></option>
            </select>
          </div>

          <!-- 5) Delivery Preference -->
          <div>
            <label id="lblDel" class="block text-[12px] font-black text-gray-700 mb-1"></label>
            <select id="deliveryPreference"
                    class="w-full bg-gray-50 border border-gray-200 rounded-2xl px-4 py-3 text-sm font-black outline-none focus:border-[#C5A059]">
              <option value="" id="optDel0"></option>
              <option value="direct" id="optDel1"></option>
              <option value="call_me" id="optDel2"></option>
            </select>
          </div>

          <!-- 6) Date (readonly) -->
          <div>
            <label id="lblDate" class="block text-[12px] font-black text-gray-700 mb-1"></label>
            <input id="date" type="text" readonly
                   class="w-full bg-gray-100 border border-gray-200 rounded-2xl px-4 py-3 text-sm font-black text-gray-700 outline-none" />
          </div>

          <!-- 7) Offer Name (readonly) -->
          <div>
            <label id="lblOffer" class="block text-[12px] font-black text-gray-700 mb-1"></label>
            <input id="offerName" type="text" readonly
                   class="w-full bg-gray-100 border border-gray-200 rounded-2xl px-4 py-3 text-sm font-black text-gray-700 outline-none" />
          </div>

          <!-- 8) Price (readonly) -->
          <div>
            <label id="lblPrice" class="block text-[12px] font-black text-gray-700 mb-1"></label>
            <input id="price" type="text" readonly
                   class="w-full bg-gray-100 border border-gray-200 rounded-2xl px-4 py-3 text-sm font-black text-gray-700 outline-none" />
          </div>

          <p id="note" class="text-[11px] text-gray-500 font-bold pt-1"></p>

          <button id="submitBtn" type="submit"
                  class="w-full bg-[#C5A059] text-black py-4 rounded-2xl font-black text-sm uppercase tracking-widest flex items-center justify-center gap-2 active:scale-[0.99] transition">
            <span id="submitText"></span>
            <span id="spinner" class="hidden w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin"></span>
          </button>

        </form>
      </div>
    </main>
  </div>

  <div id="toast" class="toast"></div>

<script>
  /* =========================
     CONFIG
     ========================= */
  const ZAPIER_HOOK_URL = "https://hooks.zapier.com/hooks/catch/14790106/ue4uy7j/"; // ŸÜŸÅÿ≥ ÿ™ÿ®ÿπŸÉ

  /* =========================
     LANG auto (AR/HE)
     ========================= */
  function detectLang(){
    const l = (navigator.language || navigator.userLanguage || "ar").toLowerCase();
    return l.startsWith("he") ? "he" : "ar";
  }
  const LANG = detectLang();

  const I18N = {
    ar: {
      badge: "AR",
      heroTitle: "ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ∑ŸÑÿ®",
      heroSub: "ÿßŸÖŸÑÿ£ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ Ÿàÿ≥Ÿäÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® ŸÅŸàÿ±Ÿãÿß",
      formTitle: "ÿ£ÿØÿÆŸÑ ÿ®ŸäÿßŸÜÿßÿ™ŸÉ ŸÑÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ∑ŸÑÿ®",
      Address: "ÿßŸÑÿπŸÜŸàÿßŸÜ",
      Name: "ÿßŸÑÿßÿ≥ŸÖ",
      Phone: "ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ",
      Pay: "ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ",
      Del: "ÿ™ŸÅÿ∂ŸäŸÑ ÿßŸÑÿ™ŸàÿµŸäŸÑ",
      Date: "ÿßŸÑÿ™ÿßÿ±ŸäÿÆ",
      Offer: "ÿßÿ≥ŸÖ ÿßŸÑÿπÿ±ÿ∂",
      Price: "ÿßŸÑÿ≥ÿπÿ±",
      pay0: "ÿßÿÆÿ™ÿ± ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ",
      pay1: "ŸÜŸÇÿØ üíµ",
      pay2: "ŸÅŸäÿ≤ÿß üí≥",
      del0: "ÿßÿÆÿ™ÿ± ÿ™ŸÅÿ∂ŸäŸÑ ÿßŸÑÿ™ŸàÿµŸäŸÑ",
      del1: "ÿ£ÿ±ÿ≥ŸÑŸàÿß ŸÖÿ®ÿßÿ¥ÿ±ÿ©",
      del2: "ÿßÿ™ÿµŸÑŸàÿß ÿ®Ÿä",
      note: "ÿ≥Ÿäÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® ÿ•ŸÑŸâ ÿßŸÑŸÜÿ∏ÿßŸÖ ÿßŸÑÿ¢ŸÜ.",
      submit: "ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®",
      sending: "ÿ¨ÿßÿ±Ÿç ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ...",
      errNeed: "Ÿäÿ±ÿ¨Ÿâ ÿ™ÿπÿ®ÿ¶ÿ© ÿßŸÑÿπŸÜŸàÿßŸÜ + ÿßŸÑÿßÿ≥ŸÖ + ÿßŸÑŸáÿßÿ™ŸÅ",
      ok: "‚úÖ ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠",
      fail: "‚ö†Ô∏è ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ÿå ÿ¨ÿ±Ÿëÿ® ŸÖÿ±ÿ© ÿ´ÿßŸÜŸäÿ©"
    },
    he: {
      badge: "HE",
      heroTitle: "◊°◊ô◊ï◊ù ◊î◊ñ◊û◊†◊î",
      heroSub: "◊û◊ú◊ê ◊§◊®◊ò◊ô◊ù ◊ï◊î◊î◊ñ◊û◊†◊î ◊™◊ô◊©◊ú◊ó ◊û◊ô◊ì",
      formTitle: "◊î◊õ◊†◊° ◊§◊®◊ò◊ô◊ù ◊ú◊°◊ô◊ï◊ù ◊î◊ñ◊û◊†◊î",
      Address: "◊õ◊™◊ï◊ë◊™",
      Name: "◊©◊ù",
      Phone: "◊ò◊ú◊§◊ï◊ü",
      Pay: "◊ê◊û◊¶◊¢◊ô ◊™◊©◊ú◊ï◊ù",
      Del: "◊î◊¢◊ì◊§◊™ ◊û◊©◊ú◊ï◊ó",
      Date: "◊™◊ê◊®◊ô◊ö",
      Offer: "◊©◊ù ◊î◊û◊ë◊¶◊¢",
      Price: "◊û◊ó◊ô◊®",
      pay0: "◊ë◊ó◊® ◊ê◊û◊¶◊¢◊ô ◊™◊©◊ú◊ï◊ù",
      pay1: "◊û◊ñ◊ï◊û◊ü üíµ",
      pay2: "◊ê◊©◊®◊ê◊ô üí≥",
      del0: "◊ë◊ó◊® ◊î◊¢◊ì◊§◊™ ◊û◊©◊ú◊ï◊ó",
      del1: "◊©◊ú◊ó◊ï ◊ô◊©◊ô◊®◊ï◊™",
      del2: "◊™◊ó◊ñ◊®◊ï ◊ê◊ú◊ô◊ô",
      note: "◊î◊î◊ñ◊û◊†◊î ◊™◊ô◊©◊ú◊ó ◊ú◊û◊¢◊®◊õ◊™ ◊õ◊¢◊™.",
      submit: "◊ê◊ô◊©◊ï◊® ◊î◊ñ◊û◊†◊î",
      sending: "◊©◊ï◊ú◊ó...",
      errNeed: "◊†◊ê ◊ú◊û◊ú◊ê ◊õ◊™◊ï◊ë◊™ + ◊©◊ù + ◊ò◊ú◊§◊ï◊ü",
      ok: "‚úÖ ◊î◊î◊ñ◊û◊†◊î ◊†◊©◊ú◊ó◊î ◊ë◊î◊¶◊ú◊ó◊î",
      fail: "‚ö†Ô∏è ◊©◊í◊ô◊ê◊î, ◊†◊°◊î ◊©◊ï◊ë"
    }
  };
  const T = I18N[LANG] || I18N.ar;

  /* =========================
     Helpers
     ========================= */
  function showToast(msg){
    const el = document.getElementById("toast");
    el.textContent = msg;
    el.style.display = "block";
    clearTimeout(showToast._t);
    showToast._t = setTimeout(()=> el.style.display = "none", 2200);
  }

  function formatDateLocal(){
    const d = new Date();
    const pad = (n)=> String(n).padStart(2,"0");
    // YYYY/MM/DD HH:mm:ss
    return `${d.getFullYear()}/${pad(d.getMonth()+1)}/${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
  }

  function getQueryParam(name){
    try{
      return new URLSearchParams(location.search).get(name) || "";
    }catch(e){ return ""; }
  }

  function setSending(on){
    const btn = document.getElementById("submitBtn");
    const sp = document.getElementById("spinner");
    const tx = document.getElementById("submitText");
    btn.disabled = !!on;
    sp.classList.toggle("hidden", !on);
    tx.textContent = on ? T.sending : T.submit;
  }

  // ‚úÖ ÿ•ÿ±ÿ≥ÿßŸÑ ŸÉŸÄ GET querystring (ŸÑÿ≠ÿ™Ÿâ Ÿäÿ∑ŸÑÿπ ÿπŸÜÿØŸÉ "Querystring ..." ŸÖÿ´ŸÑ ÿßŸÑÿµŸàÿ±ÿ©)
  function sendToZapierQuerystring(params){
    return new Promise((resolve)=>{
      const url = ZAPIER_HOOK_URL + "?" + params.toString() + "&_ts=" + Date.now();
      const img = new Image();
      img.onload = ()=> resolve(true);
      img.onerror = ()=> resolve(true); // Zapier ÿ∫ÿßŸÑÿ®Ÿãÿß Ÿäÿ≥ÿ™ŸÇÿ®ŸÑ ÿ≠ÿ™Ÿâ ŸÑŸà onerror
      img.src = url;
      // ÿßÿ≠ÿ™Ÿäÿßÿ∑: resolve ÿ®ÿπÿØ 900ms ŸÑŸà ŸÖÿß ÿµÿßÿ± ÿ¥Ÿäÿ°
      setTimeout(()=> resolve(true), 900);
    });
  }

  /* =========================
     Apply UI text
     ========================= */
  function applyUI(){
    document.documentElement.lang = LANG;
    document.documentElement.dir = "rtl"; // AR + HE
    document.getElementById("langBadge").textContent = T.badge;

    document.getElementById("heroTitle").textContent = T.heroTitle;
    document.getElementById("heroSub").textContent = T.heroSub;
    document.getElementById("formTitle").textContent = T.formTitle;

    document.getElementById("lblAddress").textContent = T.Address;
    document.getElementById("lblName").textContent = T.Name;
    document.getElementById("lblPhone").textContent = T.Phone;
    document.getElementById("lblPay").textContent = T.Pay;
    document.getElementById("lblDel").textContent = T.Del;
    document.getElementById("lblDate").textContent = T.Date;
    document.getElementById("lblOffer").textContent = T.Offer;
    document.getElementById("lblPrice").textContent = T.Price;

    document.getElementById("optPay0").textContent = T.pay0;
    document.getElementById("optPay1").textContent = T.pay1;
    document.getElementById("optPay2").textContent = T.pay2;

    document.getElementById("optDel0").textContent = T.del0;
    document.getElementById("optDel1").textContent = T.del1;
    document.getElementById("optDel2").textContent = T.del2;

    document.getElementById("note").textContent = T.note;

    document.getElementById("address").placeholder = T.Address;
    document.getElementById("name").placeholder = T.Name;
    document.getElementById("phone").placeholder = T.Phone;

    setSending(false);
  }

  /* =========================
     Prefill Offer + Price from URL
     ========================= */
  function initOfferFields(){
    const offerFromUrl = getQueryParam("offer");
    const priceFromUrl = getQueryParam("price");

    const offer = offerFromUrl ? offerFromUrl : "Y102-A118-P107-G104-B103";
    const priceNum = priceFromUrl ? Number(String(priceFromUrl).replace(/[^\d.]/g,"")) : 500;
    const price = isFinite(priceNum) && priceNum > 0 ? priceNum : 500;

    document.getElementById("offerName").value = offer;
    document.getElementById("price").value = `${Math.round(price)} ‚Ç™`;
    document.getElementById("date").value = formatDateLocal();
  }

  /* =========================
     Submit (same order as screenshot)
     ========================= */
  async function onSubmit(e){
    e.preventDefault();

    // refresh date at submit
    document.getElementById("date").value = formatDateLocal();

    const address = document.getElementById("address").value.trim();
    const name = document.getElementById("name").value.trim();
    const phone = document.getElementById("phone").value.trim();

    const paySel = document.getElementById("paymentMethod").value;
    const delSel = document.getElementById("deliveryPreference").value;

    const paymentMethodText =
      paySel === "cash" ? T.pay1.replace(" üíµ","") :
      paySel === "visa" ? T.pay2.replace(" üí≥","") : "";

    const deliveryPreferenceText =
      delSel === "direct" ? T.del1 :
      delSel === "call_me" ? T.del2 : "";

    const date = document.getElementById("date").value.trim();
    const offerName = document.getElementById("offerName").value.trim();
    const price = document.getElementById("price").value.trim(); // "500 ‚Ç™"

    if(!address || !name || !phone){
      alert(T.errNeed);
      return;
    }

    setSending(true);

    // ‚úÖ Lead (Meta) ŸÇÿ®ŸÑ ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ
    fireMetaLead({ value: Number(String(price).replace(/[^\d.]/g,"")) || 0 });

    // ‚úÖ Querystring ÿ®ŸÜŸÅÿ≥ ÿßŸÑÿ£ÿ≥ŸÖÿßÿ° ÿßŸÑŸÑŸä ÿ®ÿ™ÿ∏Ÿáÿ± ÿ®ÿßŸÑÿµŸàÿ±ÿ©
    const qs = new URLSearchParams();
    // (ŸÜŸÅÿ≥ ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ® ÿ≠ÿ±ŸÅŸäŸãÿß)
    qs.set("Address", address);
    qs.set("Name", name);
    qs.set("Phone Number", phone);
    qs.set("Payment Method", paymentMethodText || "");
    qs.set("Delivery Preference", deliveryPreferenceText || "");
    qs.set("Date", date);
    qs.set("Offer Name", offerName);
    qs.set("Price", price);

    try{
      await sendToZapierQuerystring(qs);
      showToast(T.ok);

      // reset minimal (ÿÆŸÑŸä ÿßŸÑÿπÿ±ÿ∂ ŸàÿßŸÑÿ≥ÿπÿ± ÿ≤Ÿä ŸÖÿß ŸáŸÖ)
      document.getElementById("address").value = "";
      document.getElementById("name").value = "";
      document.getElementById("phone").value = "";
      document.getElementById("paymentMethod").value = "";
      document.getElementById("deliveryPreference").value = "";
      document.getElementById("date").value = formatDateLocal();
    }catch(err){
      console.warn(err);
      showToast(T.fail);
    }

    setSending(false);
  }

  /* =========================
     Init
     ========================= */
  applyUI();
  initOfferFields();
  document.getElementById("orderForm").addEventListener("submit", onSubmit);
</script>

</body>
</html>
