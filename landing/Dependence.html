<!DOCTYPE html>
<html lang="ar" x-data="app()" x-init="init()" :dir="dir">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>MAD PARFUMEUR | Landing</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

  <!-- ‚úÖ META PIXEL + TIKTOK PIXEL (PageView) -->
  <script>
    const PIXEL_FB = "1072283127290819";
    const PIXEL_TT = "D2D02JBC77U4ENLN9SBG";

    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)n=f.fbq;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}
    (window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', PIXEL_FB);
    fbq('track', 'PageView');

    !function (w, d, t) {
      w.TiktokAnalyticsObject=t; var ttq=w[t]=w[t]||[];
      ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"];
      ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}; 
      for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);
      ttq.load=function(e,n){ var r="https://analytics.tiktok.com/i18n/pixel/events.js";
        ttq._i=ttq._i||{}; ttq._i[e]=[]; ttq._i[e]._u=r;
        ttq._t=ttq._t||{}; ttq._t[e]=+new Date; ttq._o=ttq._o||{}; ttq._o[e]=n||{};
        n=document.createElement("script"); n.type="text/javascript"; n.async=!0; n.src=r+"?sdkid="+e+"&lib="+t;
        e=document.getElementsByTagName("script")[0]; e.parentNode.insertBefore(n,e)
      };
      ttq.load(PIXEL_TT);
      ttq.page();
    }(window, document, 'ttq');
  </script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,900;1,400;1,900&family=Inter:wght@300;400;700;900&family=Amiri:wght@400;700&family=Assistant:wght@300;400;700;800&display=swap');

    :root{
      --gold:#d4af37;
      --primary:#d97706;
      --bg:#ab5c12;
    }
    body{ background:var(--bg); color:#fff; font-family:'Inter','Assistant',system-ui; }

    .glass-nav{
      position:fixed; top:0; left:0; width:100%; z-index:50;
      padding:15px 20px; display:flex; justify-content:space-between; align-items:center;
      background:rgba(0,0,0,.6); backdrop-filter:blur(12px);
      border-bottom:1px solid rgba(255,255,255,.1);
    }
    .nav-logo{ height:35px; object-fit:contain; }
    .lang-btn-nav{ font-size:11px; font-weight:900; color:rgba(255,255,255,.6); margin:0 5px; transition:.2s; }
    .lang-btn-nav.active{ color:var(--primary); }

    .hero-vid{
      position:absolute; top:0; left:0; width:100%; height:100vh; z-index:-1;
      object-fit:cover; filter:brightness(.55);
    }

    .badge{
      background:linear-gradient(to right,#d97706,#fbbf24);
      color:#000; padding:6px 22px; border-radius:999px; font-weight:900; display:inline-block;
      box-shadow:0 15px 50px rgba(0,0,0,.35);
    }

    .carousel{ position:relative; height:400px; display:flex; align-items:center; justify-content:center; }
    .c-img{ max-height:100%; max-width:100%; filter:drop-shadow(0 20px 40px rgba(0,0,0,.8)); }
    .c-btn{
      position:absolute; top:50%; transform:translateY(-50%);
      background:rgba(0,0,0,.55); color:#fff; border:1px solid rgba(255,255,255,.15);
      width:34px; height:34px; border-radius:50%; display:flex; align-items:center; justify-content:center;
      cursor:pointer; user-select:none;
    }

    .comp-row{
      display:grid; grid-template-columns:1fr 1fr; gap:2px;
      background:rgba(255,255,255,.06);
      border-radius:16px; overflow:hidden; margin-bottom:10px;
      border:1px solid rgba(255,255,255,.08);
    }
    .c-side{ padding:14px; font-size:13px; display:flex; flex-direction:column; justify-content:center; }
    .c-mad{ background:linear-gradient(to right,rgba(217,119,6,.14),rgba(217,119,6,.06)); }
    .c-alt{ background:rgba(0,0,0,.35); opacity:.85; }

    .order-grid{ display:grid; gap:10px; margin-top:12px; max-width:520px; margin-left:auto; margin-right:auto; }
    .btn-order{
      display:flex; align-items:center; justify-content:center; gap:10px;
      padding:12px; border-radius:14px; font-weight:900; text-decoration:none; transition:.2s;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.25);
      backdrop-filter: blur(10px);
    }
    .btn-order:active{ transform:scale(.98); }

    .btn-wa{ background:linear-gradient(180deg, rgba(37,211,102,.25), rgba(37,211,102,.12)); border-color:rgba(37,211,102,.25); }
    .btn-call{ background:linear-gradient(180deg, rgba(59,130,246,.25), rgba(59,130,246,.12)); border-color:rgba(59,130,246,.25); }

    .form-card{
      max-width:520px; margin:0 auto;
      background:linear-gradient(180deg, rgba(15,23,42,.78), rgba(2,6,23,.78));
      border:1px solid rgba(255,255,255,.10);
      border-radius:22px;
      padding:16px;
      box-shadow:0 20px 80px rgba(0,0,0,.45);
    }
    .inp{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      outline:none;
      color:#fff;
    }
    .inp:focus{ border-color: rgba(217,119,6,.7); box-shadow:0 0 0 3px rgba(217,119,6,.18); }
    .submit-btn{
      width:100%;
      padding:14px 14px;
      border-radius:16px;
      font-weight:900;
      color:#000;
      background:linear-gradient(to right,#d97706,#fbbf24);
      border:none;
      box-shadow:0 14px 50px rgba(0,0,0,.35);
    }
    .submit-btn:disabled{ opacity:.6; cursor:not-allowed; }

    .tiny{
      font-size:12px; color:rgba(255,255,255,.70);
    }
  </style>

  <script>
    function app(){
      return {
        // ‚úÖ ÿ∫Ÿäÿ±Ÿá ÿ•ÿ∞ÿß ÿ®ÿØŸÉ
        SCRIPT_URL: "https://script.google.com/macros/s/AKfycbzEEzQCP1xVJ9U1E15hh43sok6uRIir866l9daol-rUqXrp6dwnXusc3h9_B6miqqtE/exec",
        THANK_YOU_PATH: "/thank-you.html",
        CURRENCY: "ILS",
        VALUE_DEFAULT: null, // ŸÑŸà null ÿ®ŸÜÿ≠ÿßŸàŸÑ ŸÜÿ≥ÿ™ÿÆÿ±ÿ¨ ŸÖŸÜ ÿßŸÑÿ≥ÿπÿ±
        WA_NUMBER: "972509787730",
        CALL_NUMBER: "*9935",

        c: {
          logo: "https://madperfume.ps/upload/01-2026/page/69735b87d92ef.png",
          vid: "https://madperfume.ps/upload/01-2026/page/69738a53a1998.mp4#t=0.02",
          heroes: ["https://madperfume.ps/upload/01-2026/page/An_C_CgzIpu9EXMo9pdzVdfq8wAzSksIwyf5ZyhFqeQj3CAfge509Q5oLQ1hD9MRECqJ-2z6sHF1_N5VP4Q_BHNpvfiHOPGPepws5uPfzY66GEaOF-OKOFsv5jVXZcBS4BiVnHYlSFbJQFmiYNKQr2n1BixCpqbI15Luxz1Ch44pTkgdIlBwUQsCG7Gw9yDduKKZA0yKNfFmzXUDNuJKV.jpeg"],
          blocks: [
            {
              type:"text",
              text:{
                ar:"Exotic Oud ‚Äî ÿ™ÿ¨ÿ±ÿ®ÿ© ÿπŸàÿØ ŸÅÿßÿÆÿ±ÿ© Ÿàÿ´ŸÇŸäŸÑÿ© ÿ®ÿ´ÿ®ÿßÿ™ ŸÇŸàŸä.\n\n‚úÖ ŸÖŸÜÿßÿ≥ÿ® ŸÑŸÑŸäŸÑ ŸàÿßŸÑŸÖŸÜÿßÿ≥ÿ®ÿßÿ™\n‚úÖ ÿ±ÿßÿ¶ÿ≠ÿ© ÿπŸàÿØ ŸÖŸÜÿ™ŸÇÿßÿ© ÿ®ÿπŸÜÿßŸäÿ©\n‚úÖ ŸÅÿÆÿßŸÖÿ© ŸÖŸÜ ÿ£ŸàŸÑ ÿ±ÿ¥ÿ©",
                he:"Exotic Oud ‚Äî ◊ó◊ï◊ï◊ô◊ô◊™ ◊ê◊ï◊ì ◊ô◊ï◊ß◊®◊™◊ô◊™ ◊ï◊¢◊©◊ô◊®◊î ◊¢◊ù ◊¢◊û◊ô◊ì◊ï◊™ ◊ó◊ñ◊ß◊î.\n\n‚úÖ ◊û◊™◊ê◊ô◊ù ◊ú◊¢◊®◊ë ◊ï◊ú◊ê◊ô◊®◊ï◊¢◊ô◊ù\n‚úÖ ◊ê◊ï◊ì ◊û◊ï◊ë◊ó◊® ◊ë◊ß◊§◊ô◊ì◊î\n‚úÖ ◊ô◊ï◊ß◊®◊î ◊û◊î◊©◊§◊®◊ô◊• ◊î◊®◊ê◊©◊ï◊ü"
              }
            }
          ],
          showManifesto: true,
          compItems: {
            ar: [
              {mad:"ŸÖŸÉŸàŸëŸÜÿßÿ™ ŸÖŸÅÿ≠Ÿàÿµÿ© ŸàŸÖÿπÿ™ŸÖÿØÿ©", local:"ŸÖÿµÿØÿ± ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ"},
              {mad:"ÿ´ÿ®ÿßÿ™ ŸÇŸàŸä + ÿ≥ÿßÿπÿßÿ™ ÿ∑ŸàŸäŸÑÿ©", local:"ŸäÿÆÿ™ŸÅŸä ÿ®ÿ≥ÿ±ÿπÿ©"},
              {mad:"ÿÆÿØŸÖÿ© ÿ≤ÿ®ÿßÿ¶ŸÜ *9935", local:"ÿ®ÿØŸàŸÜ ÿØÿπŸÖ"}
            ],
            he: [
              {mad:"◊®◊õ◊ô◊ë◊ô◊ù ◊†◊ë◊ì◊ß◊ï ◊ï◊ê◊ï◊©◊®◊ï", local:"◊û◊ß◊ï◊® ◊ú◊ê ◊ô◊ì◊ï◊¢"},
              {mad:"◊¢◊û◊ô◊ì◊ï◊™ ◊ó◊ñ◊ß◊î ◊ú◊©◊¢◊ï◊™", local:"◊†◊¢◊ú◊ù ◊û◊î◊®"},
              {mad:"◊©◊ô◊®◊ï◊™ ◊ú◊ß◊ï◊ó◊ï◊™ *9935", local:"◊ú◊ú◊ê ◊™◊û◊ô◊õ◊î"}
            ]
          }
        },

        db:{
          ar:{
            offer:"üî• ÿπÿ±ÿ∂ ÿßŸÑŸäŸàŸÖ",
            price:"240 ‚Ç™ ÿ¥ÿßŸÖŸÑ ÿßŸÑÿ™ŸàÿµŸäŸÑ",
            cta:"ÿßÿ∑ŸÑÿ® ÿßŸÑÿ¢ŸÜ",
            formTitle:"ŸÜŸÖŸàÿ∞ÿ¨ ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑÿ≥ÿ±Ÿäÿπ",
            name:"ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÉÿßŸÖŸÑ",
            phone:"ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ",
            city:"ÿßŸÑŸÖÿØŸäŸÜÿ© (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)",
            notes:"ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)",
            submit:"ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® ‚úÖ",
            sending:"ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ...",
            ok:"ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠ ‚úÖ",
            fail:"ÿ≠ÿµŸÑ ÿÆÿ∑ÿ£ÿå ÿ¨ÿ±Ÿëÿ® ŸÖÿ±ÿ© ÿ´ÿßŸÜŸäÿ©.",
            wa:"ÿßÿ∑ŸÑÿ® ÿπÿ®ÿ± Ÿàÿßÿ™ÿ≥ÿßÿ®",
            call:"ÿßÿ™ÿµŸÑ ŸÑŸÑÿ∑ŸÑÿ®",
            manifestoT:"THE MANIFESTO",
            manifestoS:"ŸÑŸÖÿßÿ∞ÿß MADÿü ŸÖŸÇÿßÿ±ŸÜÿ© ÿ≥ÿ±Ÿäÿπÿ©"
          },
          he:{
            offer:"üî• ◊û◊ë◊¶◊¢ ◊î◊ô◊ï◊ù",
            price:"240‚Ç™ ◊õ◊ï◊ú◊ú ◊û◊©◊ú◊ï◊ó",
            cta:"◊î◊ñ◊û◊ü ◊¢◊õ◊©◊ô◊ï",
            formTitle:"◊ò◊ï◊§◊° ◊î◊ñ◊û◊†◊î ◊û◊î◊ô◊®",
            name:"◊©◊ù ◊û◊ú◊ê",
            phone:"◊ò◊ú◊§◊ï◊ü",
            city:"◊¢◊ô◊® (◊ê◊ï◊§◊¶◊ô◊ï◊†◊ú◊ô)",
            notes:"◊î◊¢◊®◊ï◊™ (◊ê◊ï◊§◊¶◊ô◊ï◊†◊ú◊ô)",
            submit:"◊©◊ú◊ó ◊î◊ñ◊û◊†◊î ‚úÖ",
            sending:"◊©◊ï◊ú◊ó...",
            ok:"◊î◊î◊ñ◊û◊†◊î ◊†◊©◊ú◊ó◊î ◊ë◊î◊¶◊ú◊ó◊î ‚úÖ",
            fail:"◊©◊í◊ô◊ê◊î, ◊†◊°◊ï ◊©◊ï◊ë.",
            wa:"◊î◊ñ◊û◊ü ◊ë◊ï◊ï◊ê◊ò◊°◊ê◊§",
            call:"◊ó◊ô◊ô◊í ◊ú◊î◊ñ◊û◊†◊î",
            manifestoT:"THE MANIFESTO",
            manifestoS:"◊ú◊û◊î MAD? ◊î◊©◊ï◊ï◊ê◊î ◊ß◊¶◊®◊î"
          }
        },

        lang:"ar",
        idx:0,

        // form state
        f:{ name:"", phone:"", city:"", notes:"" },
        ui:{ loading:false, msg:"", ok:false },

        // ‚úÖ dir: AR + HE = RTL
        get dir(){ return (this.lang==="ar" || this.lang==="he") ? "rtl" : "ltr"; },
        get t(){ return this.db[this.lang]; },

        // Offer name from file: Exotic Oud.html => Exotic Oud
        get offerName(){
          try{
            const p = (location.pathname.split("/").pop() || "").replace(".html","");
            const clean = decodeURIComponent(p || "");
            return clean || "MAD Offer";
          }catch(e){ return "MAD Offer"; }
        },
        get contentId(){
          return (this.offerName || "MAD_OFFER").toUpperCase().replace(/\s+/g,"_").replace(/[^\w]/g,"_");
        },
        get valueNum(){
          if(this.VALUE_DEFAULT && Number(this.VALUE_DEFAULT)>0) return Number(this.VALUE_DEFAULT);
          // ÿ≠ÿßŸàŸÑ ÿßÿ≥ÿ™ÿÆÿ±ÿßÿ¨ ÿ±ŸÇŸÖ ŸÖŸÜ price
          const s = (this.t.price || "");
          const m = s.match(/(\d{2,4})/);
          return m ? Number(m[1]) : 500;
        },
        get backUrl(){
          return location.pathname + location.search + location.hash;
        },

        init(){
          // auto-lang from browser if not forced
          const qs = new URLSearchParams(location.search||"");
          const ql = (qs.get("lang")||"").toLowerCase();
          if(ql==="ar" || ql==="he") this.lang = ql;
          else {
            const ul = (navigator.language||"").toLowerCase();
            this.lang = ul.startsWith("he") ? "he" : "ar";
          }

          if(window.lucide) lucide.createIcons();
          if(this.c.heroes.length>1) setInterval(()=>this.next(), 3000);

          // üî• Track view content when user reaches #shop
          this.observeShop();
        },

        tog(l){ this.lang=l; },

        next(){ this.idx = (this.idx===this.c.heroes.length-1)?0:this.idx+1; },
        prev(){ this.idx = (this.idx===0)?this.c.heroes.length-1:this.idx-1; },

        // ========== PIXEL HELPERS ==========
        fireFB(ev, pl, eid){
          try{
            if(typeof fbq==="undefined") return;
            if(eid) fbq("track", ev, pl||{}, {eventID:eid});
            else fbq("track", ev, pl||{});
          }catch(e){}
        },
        fireTT(ev, pl){
          try{
            if(typeof ttq==="undefined") return;
            ttq.track(ev, pl||{});
          }catch(e){}
        },
        // ‚úÖ "ŸÑŸÉŸÑ ÿ¥Ÿä" ŸÜÿ≥ÿ™ÿπŸÖŸÑ Lead + ŸÜÿ∂ŸäŸÅ source + offer
        trackLead(source, extra){
          const payload = Object.assign({
            source: source || "unknown",
            content_name: this.offerName,
            content_id: this.contentId,
            value: this.valueNum,
            currency: this.CURRENCY
          }, extra||{});

          // event id ŸÑŸÖŸÜÿπ ÿ™ŸÉÿ±ÿßÿ± Ÿàÿ™ŸàÿßŸÅŸÇ
          const eid = "MAD-" + Date.now() + "-" + Math.random().toString(16).slice(2);

          this.fireFB("Lead", payload, eid);
          this.fireTT("Lead", Object.assign({event_id:eid}, payload));
        },
        trackViewContent(){
          const payload = {
            content_name: this.offerName,
            content_id: this.contentId,
            value: this.valueNum,
            currency: this.CURRENCY
          };
          this.fireFB("ViewContent", payload);
          this.fireTT("ViewContent", payload);
        },

        observeShop(){
          try{
            const el = document.getElementById("shop");
            if(!el) return;
            const io = new IntersectionObserver((entries)=>{
              entries.forEach(en=>{
                if(en.isIntersecting){
                  this.trackViewContent();
                  io.disconnect();
                }
              });
            }, {threshold:0.35});
            io.observe(el);
          }catch(e){}
        },

        // ========== FORM SUBMIT ==========
        async submitOrder(){
          if(this.ui.loading) return;

          // basic validation
          const name = (this.f.name||"").trim();
          const phone = (this.f.phone||"").trim();
          if(!name || !phone){
            this.ui.msg = (this.lang==="he") ? "◊†◊ê ◊ú◊û◊ú◊ê ◊©◊ù ◊ï◊ò◊ú◊§◊ï◊ü." : "ŸÑÿßÿ≤ŸÖ ÿ™ŸÉÿ™ÿ® ÿßŸÑÿßÿ≥ŸÖ Ÿàÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ.";
            this.ui.ok = false;
            return;
          }

          // prevent double submits per session
          const LOCK = "MAD_ORDER_SENT_LOCK_V1";
          try{
            if(sessionStorage.getItem(LOCK)==="1") return;
            sessionStorage.setItem(LOCK,"1");
          }catch(e){}

          this.ui.loading = true;
          this.ui.msg = "";
          this.ui.ok = false;

          // order id
          const orderId = "MAD-" + Date.now();

          // ‚úÖ ŸÑÿß ŸÜÿ∑ŸÑŸÇ Lead ÿ•ŸÑÿß ÿ®ÿπÿØ ŸÜÿ¨ÿßÿ≠ ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ
          const fd = new FormData();
          fd.append("order_id", orderId);
          fd.append("ts", new Date().toISOString());
          fd.append("lang", this.lang);
          fd.append("offer", this.offerName);
          fd.append("content_id", this.contentId);
          fd.append("value", String(this.valueNum));
          fd.append("currency", this.CURRENCY);
          fd.append("name", name);
          fd.append("phone", phone);
          fd.append("city", (this.f.city||"").trim());
          fd.append("notes", (this.f.notes||"").trim());
          fd.append("page_url", location.href);

          // timeout
          const ctl = new AbortController();
          const tmr = setTimeout(()=>ctl.abort(), 9000);

          try{
            const res = await fetch(this.SCRIPT_URL, {
              method: "POST",
              body: fd,
              signal: ctl.signal,
              // ŸÑŸà ŸÉÿßŸÜ ÿπŸÜÿØŸÉ CORS ŸÖÿ∂ÿ®Ÿàÿ∑ ÿ±ÿ≠ Ÿäÿ¥ÿ™ÿ∫ŸÑÿå ŸÑŸà ŸÑÿ£ ÿ∫ÿßŸÑÿ®Ÿãÿß opaque
              mode: "cors"
            }).catch(async()=>{
              // fallback: no-cors (opaque) ‚Äî Ÿäÿπÿ™ÿ®ÿ± ÿ£ŸÜŸá ÿÆÿ±ÿ¨ ÿßŸÑÿ∑ŸÑÿ®
              return fetch(this.SCRIPT_URL, { method:"POST", body: fd, mode:"no-cors" });
            });

            clearTimeout(tmr);

            // ÿ•ÿ∞ÿß ÿ±ÿ¨ÿπ ÿ±ÿØ Ÿàÿßÿ∂ÿ≠ ŸàŸÅÿ¥ŸÑ
            if(res && res.type !== "opaque" && res.ok === false){
              throw new Error("server_not_ok");
            }

            // ‚úÖ ÿ™ÿ£ŸÉŸäÿØ: ŸÜÿÆÿ≤ŸÜ ORDER_OK ŸÑŸÑŸÄ thank-you
            try{
              sessionStorage.setItem("MAD_ORDER_OK_V1","1");
            }catch(e){}

            // ‚úÖ ÿßŸÑÿ¢ŸÜ ŸÜÿ∑ŸÑŸÇ Lead (ÿ™ŸÖ ÿßŸÑÿ∑ŸÑÿ® ŸÅÿπŸÑŸäŸãÿß)
            this.trackLead("form_submit", { order_id: orderId });

            this.ui.ok = true;
            this.ui.msg = this.t.ok;

            // redirect to thank you ŸÖÿπ ŸÉŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ + back + mad_ty=1
            const ty = new URL(this.THANK_YOU_PATH, location.origin);
            ty.searchParams.set("lang", this.lang);
            ty.searchParams.set("value", String(this.valueNum));
            ty.searchParams.set("currency", this.CURRENCY);
            ty.searchParams.set("item", this.offerName);
            ty.searchParams.set("content_id", this.contentId);
            ty.searchParams.set("back", this.backUrl);
            ty.searchParams.set("mad_ty", "1");

            setTimeout(()=>{ location.href = ty.toString(); }, 450);

          }catch(err){
            clearTimeout(tmr);
            try{ sessionStorage.removeItem(LOCK); }catch(e){}
            this.ui.ok = false;
            this.ui.msg = this.t.fail;
            this.ui.loading = false;
          }
        },

        // buttons tracking
        clickWA(){
          this.trackLead("whatsapp_click");
          const msg = (this.lang==="he")
            ? `◊©◊ú◊ï◊ù, ◊ê◊†◊ô ◊®◊ï◊¶◊î ◊ú◊î◊ñ◊û◊ô◊ü: ${this.offerName}`
            : `ŸÖÿ±ÿ≠ÿ®ÿßŸãÿå ÿ£ÿ±ŸäÿØ ÿ∑ŸÑÿ®: ${this.offerName}`;
          window.open(`https://wa.me/${this.WA_NUMBER}?text=${encodeURIComponent(msg)}`, "_blank");
        },
        clickCall(){
          this.trackLead("call_click");
          location.href = `tel:${this.CALL_NUMBER}`;
        },
        clickCTA(){
          this.trackViewContent();
          location.href = "#shop";
        }
      }
    }
  </script>
</head>

<body>

  <nav class="glass-nav">
    <div class="flex gap-2">
      <button @click="tog('ar')" class="lang-btn-nav" :class="lang=='ar'?'active':''">AR</button>
      <button @click="tog('he')" class="lang-btn-nav" :class="lang=='he'?'active':''">HE</button>
    </div>

    <img :src="c.logo" class="nav-logo" alt="MAD" referrerpolicy="no-referrer">

    <div class="w-8">
      <i data-lucide="shopping-bag" style="color:white; width:20px;"></i>
    </div>
  </nav>

  <!-- HERO -->
  <section class="relative h-screen flex flex-col justify-center items-center text-center px-4">
    <video :src="c.vid" autoplay loop muted playsinline class="hero-vid"></video>

    <div class="badge mb-3" x-text="t.offer"></div>

    <h1 class="text-5xl md:text-6xl font-serif italic mb-4 drop-shadow" x-text="t.price"></h1>

    <div class="text-sm opacity-90 mb-6 font-bold">
      <span class="px-3 py-1 rounded-full bg-black/30 border border-white/10" x-text="offerName"></span>
    </div>

    <button @click="clickCTA()" class="bg-amber-600 text-black px-8 py-3 rounded-full font-black shadow-xl">
      <span x-text="t.cta"></span>
    </button>
  </section>

  <!-- SHOP -->
  <section id="shop" class="py-16 px-4 text-center">
    <!-- Carousel -->
    <div class="carousel mb-10">
      <template x-for="(src,i) in c.heroes" :key="i">
        <img :src="src" x-show="idx===i" class="c-img" x-transition.opacity referrerpolicy="no-referrer">
      </template>

      <template x-if="c.heroes.length>1">
        <div>
          <button class="c-btn" style="left:10px" @click="prev()">‚Äπ</button>
          <button class="c-btn" style="right:10px" @click="next()">‚Ä∫</button>
        </div>
      </template>
    </div>

    <!-- Content blocks -->
    <div class="space-y-8 max-w-2xl mx-auto mb-10 text-right">
      <template x-for="(block,bi) in c.blocks" :key="bi">
        <div class="text-gray-100/90 whitespace-pre-wrap leading-7 text-[15px]" x-text="block.text[lang]"></div>
      </template>
    </div>

    <!-- Manifesto -->
    <template x-if="c.showManifesto">
      <div class="max-w-2xl mx-auto mb-12 text-right">
        <h2 class="text-3xl font-serif italic mb-2 text-white text-center" x-text="t.manifestoT"></h2>
        <p class="text-white/70 text-center mb-6 text-sm" x-text="t.manifestoS"></p>

        <template x-for="(item,ii) in c.compItems[lang]" :key="ii">
          <div class="comp-row">
            <div class="c-side c-mad">
              <div class="flex items-center justify-between mb-1">
                <span class="text-[11px] font-black text-amber-300">MAD</span>
                <i data-lucide="check-circle" class="w-4 h-4 text-amber-300"></i>
              </div>
              <p class="text-white font-black" x-text="item.mad"></p>
            </div>
            <div class="c-side c-alt">
              <div class="flex items-center justify-between mb-1">
                <span class="text-[11px] font-black text-rose-300">OTHERS</span>
                <i data-lucide="x-circle" class="w-4 h-4 text-rose-300"></i>
              </div>
              <p class="text-white/80" x-text="item.local"></p>
            </div>
          </div>
        </template>
      </div>
    </template>

    <!-- ‚úÖ FORM (GOOGLE SHEET) -->
    <div class="form-card text-right">
      <div class="flex items-center justify-between mb-3">
        <h3 class="font-black text-lg" x-text="t.formTitle"></h3>
        <span class="text-[11px] px-3 py-1 rounded-full bg-black/30 border border-white/10" x-text="offerName"></span>
      </div>

      <form @submit.prevent="submitOrder()" class="grid gap-3">
        <input class="inp" type="text" x-model="f.name" :placeholder="t.name" required>
        <input class="inp" type="tel" x-model="f.phone" :placeholder="t.phone" required>
        <input class="inp" type="text" x-model="f.city" :placeholder="t.city">
        <textarea class="inp" rows="3" x-model="f.notes" :placeholder="t.notes"></textarea>

        <button class="submit-btn" type="submit" :disabled="ui.loading">
          <span x-show="!ui.loading" x-text="t.submit"></span>
          <span x-show="ui.loading" x-text="t.sending"></span>
        </button>

        <div class="tiny text-center" :class="ui.ok ? 'text-green-200' : 'text-rose-200'" x-show="ui.msg" x-text="ui.msg"></div>
        <div class="tiny text-center text-white/70">
          <span x-text="(lang==='he') ? '◊™◊©◊ú◊ï◊ù ◊ë◊û◊¢◊û◊ì ◊î◊û◊°◊ô◊®◊î ‚Ä¢ ◊û◊©◊ú◊ï◊ó ◊û◊î◊ô◊®' : 'ÿßŸÑÿØŸÅÿπ ÿπŸÜÿØ ÿßŸÑÿßÿ≥ÿ™ŸÑÿßŸÖ ‚Ä¢ ÿ™ŸàÿµŸäŸÑ ÿ≥ÿ±Ÿäÿπ'"></span>
        </div>
      </form>
    </div>

    <!-- Quick actions -->
    <div class="order-grid mt-4">
      <button class="btn-order btn-wa" type="button" @click="clickWA()">
        <i data-lucide="message-circle"></i>
        <span x-text="t.wa"></span>
      </button>

      <button class="btn-order btn-call" type="button" @click="clickCall()">
        <i data-lucide="phone"></i>
        <span x-text="t.call"></span>
      </button>
    </div>
  </section>

  <footer class="py-6 text-center text-xs text-white/60">¬© 2026 MAD PARFUMEUR</footer>

</body>
</html>
