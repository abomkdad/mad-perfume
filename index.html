<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>MAD PARFUMEUR | Offers</title>

<!-- FONTS & ICONS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- META PIXEL -->
<script>
!function(f,b,e,v,n,t,s){
if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window,document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init','1072283127290819');
fbq('track','PageView');
</script>

<!-- TIKTOK PIXEL -->
<script>
!function (w, d, t) {
  w.TiktokAnalyticsObject=t;
  var ttq=w[t]=w[t]||[];
  ttq.methods=["page","track","identify"];
  ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};
  for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);
  ttq.load=function(e){
    var i=d.createElement("script");
    i.type="text/javascript";
    i.async=!0;
    i.src="https://analytics.tiktok.com/i18n/pixel/events.js?sdkid="+e;
    var n=d.getElementsByTagName("script")[0];
    n.parentNode.insertBefore(i,n)};
  ttq.load("D2D02JBC77U4ENLN9SBG");
  ttq.page();
}(window, document, 'ttq');
</script>

<style>
:root{
--bg:#0b0b0b;
--card:#151515;
--gold:#d4af37;
--text:#fff;
--muted:#aaa;
}

body{
margin:0;
background:var(--bg);
color:var(--text);
font-family:system-ui,-apple-system,BlinkMacSystemFont;
}

header{
background:#000;
padding:15px;
text-align:center;
border-bottom:1px solid #222;
}

header img{
max-width:160px;
margin-bottom:10px;
}

.category-bar{
display:flex;
gap:10px;
overflow-x:auto;
padding:12px;
background:#0e0e0e;
border-bottom:1px solid #222;
}

.category-bar button{
background:#111;
color:#fff;
border:1px solid #333;
padding:8px 16px;
border-radius:20px;
cursor:pointer;
white-space:nowrap;
transition:.2s;
}

.category-bar button.active,
.category-bar button:hover{
background:var(--gold);
color:#000;
border-color:var(--gold);
}

.container{
max-width:1100px;
margin:auto;
padding:20px;
}

.branch-card{
background:var(--card);
border:1px solid #222;
border-radius:10px;
padding:18px;
margin-bottom:20px;
}

.branch-title{
font-size:22px;
color:var(--gold);
margin-bottom:6px;
}

.branch-hours{
color:var(--muted);
font-size:14px;
margin-bottom:15px;
}

.branch-actions{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
gap:10px;
}

.branch-actions a{
text-decoration:none;
background:#111;
border:1px solid var(--gold);
color:var(--gold);
padding:10px;
border-radius:8px;
text-align:center;
font-weight:bold;
transition:.2s;
}

.branch-actions a:hover{
background:var(--gold);
color:#000;
}

.products{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
gap:15px;
margin-top:20px;
}

.product{
background:#fff;
border-radius:8px;
padding:10px;
color:#000;
text-align:center;
}

.product img{
max-width:100%;
height:140px;
object-fit:contain;
}

.product-title{
font-size:13px;
font-weight:bold;
margin:6px 0;
}

.product-price{
color:#b8860b;
font-weight:bold;
}

.product a{
display:block;
margin-top:8px;
background:#25d366;
color:#fff;
padding:8px;
border-radius:6px;
text-decoration:none;
font-size:13px;
}

/* FLOATING WHATSAPP */
.wa-float{
position:fixed;
bottom:20px;
right:20px;
background:#25d366;
color:#fff;
width:60px;
height:60px;
border-radius:50%;
display:flex;
align-items:center;
justify-content:center;
font-size:30px;
z-index:999;
box-shadow:0 0 20px rgba(0,0,0,.4);
}
</style>
</head>

<body>

<header>
<img src="https://abomkdad.github.io/Digital-Business-Card/logo.png">
</header>

<div id="categories" class="category-bar"></div>

<div class="container">
<div id="branches"></div>
</div>

<a id="waFloat" class="wa-float" target="_blank">
<i class="fab fa-whatsapp"></i>
</a>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

<script>
const BRANCH_FILE="branches.csv";
const PRODUCT_FILE="products.csv";

let LANG=navigator.language.startsWith("he")?"he":"ar";
document.documentElement.dir=LANG==="he"?"ltr":"rtl";

let PRODUCTS=[];
let CAT1="",CAT2="";

function loadProducts(){
Papa.parse(PRODUCT_FILE,{
download:true,
header:true,
complete:r=>{
PRODUCTS=r.data.filter(p=>p.Title);
const h=r.meta.fields;
CAT1=h[h.length-1];
CAT2=h[h.length-2];
buildCategories();
renderProducts(PRODUCTS);
}});
}

function categoryOf(p){
return p[CAT1]||p[CAT2]||"";
}

function buildCategories(){
const cats=[...new Set(PRODUCTS.map(categoryOf).filter(Boolean))];
const bar=document.getElementById("categories");
bar.innerHTML="";

const allBtn=document.createElement("button");
allBtn.textContent=LANG==="he"?"הכל":"الكل";
allBtn.className="active";
allBtn.onclick=()=>{setActive(allBtn);renderProducts(PRODUCTS)};
bar.appendChild(allBtn);

cats.forEach(c=>{
const b=document.createElement("button");
b.textContent=c;
b.onclick=()=>{
setActive(b);
renderProducts(PRODUCTS.filter(p=>categoryOf(p)===c));
};
bar.appendChild(b);
});
}

function setActive(btn){
document.querySelectorAll(".category-bar button").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
}

function renderProducts(list){
const c=document.getElementById("branches");
c.innerHTML="";
list.forEach(p=>{
c.innerHTML+=`
<div class="product">
<img src="${(p.Image||"").split("|")[0]}">
<div class="product-title">${p.Title}</div>
<div class="product-price">${p.Price} ₪</div>
<a href="#" onclick="openWA('${p.Title}')">
<i class="fab fa-whatsapp"></i> ${LANG==="he"?"בדוק זמינות":"افحص التوفر"}
</a>
</div>`;
});
}

function openWA(title){
const msg=LANG==="he"
?`שלום, האם הבושם ${title} זמין?`
:`مرحباً، هل العطر ${title} متوفر؟`;
document.getElementById("waFloat").href=`https://wa.me/?text=${encodeURIComponent(msg)}`;
}

loadProducts();
</script>

</body>
</html>
