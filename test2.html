<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAD PARFUMEUR | Official Directory</title>

    <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){
    n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init','1072283127290819');
    fbq('track','PageView');
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;700;800&family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --gold: #d4af37;
            --dark-bg: #0a0a0a;
            --card-bg: #161616;
            --wa-green: #25D366;
            --waze-blue: #33CCFF;
            --text-main: #ffffff;
            --text-muted: #b3b3b3;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            background-color: var(--dark-bg);
            color: var(--text-main);
            font-family: 'Assistant', 'Cairo', sans-serif;
            line-height: 1.6;
            overflow-x: hidden;
            opacity: 0; transition: opacity 0.5s;
        }

        /* --- Hero Section --- */
        .hero-section {
            background: linear-gradient(rgba(0,0,0,0.85), rgba(0,0,0,0.9)), 
                        url('https://madparfumeurglobal.com/wp-content/uploads/2025/10/1920x600-BERGAY.jpg') center/cover;
            padding: 40px 20px 70px;
            text-align: center;
            border-bottom: 2px solid var(--gold);
        }

        .logo-container img {
            width: 100px;
            filter: drop-shadow(0 0 10px rgba(212,175,55,0.3));
            margin-bottom: 10px;
        }

        .brand-title {
            font-size: 26px;
            font-weight: 900;
            letter-spacing: 1px;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        /* --- Social Bar --- */
        .social-bar {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 25px;
        }

        .social-bar a {
            color: white; font-size: 16px; width: 35px; height: 35px;
            background: rgba(255,255,255,0.08); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            transition: 0.3s; border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .social-bar a:hover { background: var(--gold); color: black; transform: translateY(-3px); }

        /* --- Quick Action Grid (3 Columns) --- */
        .action-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            max-width: 600px;
            margin: 0 auto;
        }

        .action-item {
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.4);
            padding: 15px 5px;
            border-radius: 12px;
            text-decoration: none;
            color: white;
            transition: 0.3s;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .action-item:hover { background: rgba(212, 175, 55, 0.2); border-color: var(--gold); transform: translateY(-3px); }
        .action-item i { font-size: 20px; color: var(--gold); margin-bottom: 6px; }
        .action-item span { display: block; font-weight: 800; font-size: 12px; white-space: nowrap; }
        .action-item small { display: block; opacity: 0.8; font-size: 10px; margin-top: 2px; }
        .action-item .hotline { display: block; color: var(--gold); font-size: 16px; font-weight: 900; margin-top: 4px; }

        /* --- Branch List --- */
        .container { max-width: 800px; margin: -35px auto 50px; padding: 0 15px; position: relative; z-index: 10; }
        
        .branch-card {
            background: var(--card-bg); border-radius: 20px; padding: 25px;
            margin-bottom: 20px; border-right: 5px solid var(--gold);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); transition: 0.3s;
        }

        .branch-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; }
        .branch-name-box h3 { font-size: 20px; font-weight: 800; color: var(--gold); margin-bottom: 5px; }
        .dist-info { font-size: 13px; color: var(--text-muted); font-weight: bold; }

        .status-pill {
            font-size: 11px; padding: 4px 10px; border-radius: 25px; font-weight: 800;
            display: flex; align-items: center; gap: 5px;
        }
        .status-pill.open { border: 1px solid var(--wa-green); color: var(--wa-green); background: rgba(37, 211, 102, 0.1); }
        .status-pill.closed { border: 1px solid #ff4d4d; color: #ff4d4d; background: rgba(255, 77, 77, 0.1); }
        .dot { width: 7px; height: 7px; border-radius: 50%; display: inline-block; }

        .btn-group { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        .btn {
            padding: 12px 5px; border-radius: 12px; text-decoration: none; color: white;
            font-weight: 800; font-size: 12px; text-align: center;
            display: flex; flex-direction: column; align-items: center; gap: 5px; transition: 0.2s;
        }
        .bg-wa { background: var(--wa-green); }
        .bg-waze { background: var(--waze-blue); color: #000; }
        .bg-enter { background: #333; }

        /* --- Popup & Floating Widget --- */
        #offer-modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            display: none; align-items: center; justify-content: center; z-index: 10000; padding: 20px;
        }
        .modal-content {
            width: 100%; max-width: 400px; background: #111;
            border: 2px solid var(--gold); border-radius: 30px;
            overflow: hidden; text-align: center; position: relative;
        }
        .modal-timer { background: var(--gold); color: black; padding: 12px; font-weight: 900; font-size: 1.6rem; }
        .modal-btn { display: block; margin: 20px; background: var(--wa-green); color: white; padding: 18px; border-radius: 50px; text-decoration: none; font-weight: 900; font-size: 18px; }
        
        #offer-trigger {
            position: fixed; bottom: 25px; right: 25px; background: var(--gold); color: black;
            padding: 12px 20px; border-radius: 50px; display: none; font-weight: 900; z-index: 999;
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4); animation: bounce 2s infinite; cursor: pointer;
        }

        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }

        /* LTR adjustments */
        [dir="ltr"] .branch-card { border-right: none; border-left: 5px solid var(--gold); }
        [dir="ltr"] .action-item .hotline { direction: ltr; }
    </style>
</head>
<body>

<section class="hero-section">
    <div class="logo-container">
        <img src="https://abomkdad.github.io/Digital-Business-Card/logo.png" alt="MAD Logo">
    </div>
    <h1 class="brand-title">MAD PARFUMEUR ISRAEL</h1>

    <div class="social-bar">
        <a href="https://www.facebook.com/MADPARFUMEURISRAEL/" target="_blank"><i class="fab fa-facebook-f"></i></a>
        <a href="https://www.instagram.com/perfume.mad/" target="_blank"><i class="fab fa-instagram"></i></a>
        <a href="https://www.tiktok.com/@mad.perfume" target="_blank"><i class="fab fa-tiktok"></i></a>
        <a href="https://snapchat.com/t/jbtN32Xe" target="_blank"><i class="fab fa-snapchat"></i></a>
        <a href="https://www.youtube.com/watch?v=NVCKAp2-6HM" target="_blank"><i class="fab fa-youtube"></i></a>
        <a href="mailto:info@madperume.co.il"><i class="fas fa-envelope"></i></a>
    </div>

    <div class="action-grid">
        <a href="tel:*9935" class="action-item" onclick="fbq('track', 'Contact')">
            <i class="fas fa-phone-alt"></i>
            <span id="h-cs">Ø®Ø¯Ù…Ø© Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†</span>
            <small>×©×™×¨×•×ª ×œ×§×•×—×•×ª</small>
            <div class="hotline">*9935</div>
        </a>

        <a href="https://wa.me/972509787730" class="action-item" onclick="fbq('track', 'Contact')">
            <i class="fab fa-whatsapp"></i>
            <span id="h-wa">ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø´Ø±ÙƒØ©</span>
            <small>×•×•××˜×¡××¤ ×—×‘×¨×”</small>
            <div class="hotline" style="font-size:10px;">050-978-7730</div>
        </a>

        <a id="online-btn" href="#" class="action-item" onclick="fbq('track', 'InitiateCheckout')">
            <i class="fas fa-shopping-bag"></i>
            <span id="h-shop">Ø§Ù„Ø·Ù„Ø¨ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</span>
            <small>×”×–×× ×” ××•× ×œ×™×™×Ÿ</small>
            <div class="hotline" style="font-size:12px;">Shop Now</div>
        </a>
    </div>
</section>

<div class="container" id="branchesList">
    </div>

<div id="offer-modal">
    <div class="modal-content">
        <div id="modal-timer" class="modal-timer">00:00:00</div>
        <img src="sale.png" style="width: 100%;" alt="Daily Sale">
        <a id="get-offer-btn" href="#" class="modal-btn"></a>
        <div onclick="closeOffer()" style="padding: 15px; cursor: pointer; opacity: 0.6; font-size: 14px; font-weight: bold;">
            Ø¥ØºÙ„Ø§Ù‚ / ×¡×’×•×¨
        </div>
    </div>
</div>

<div id="offer-trigger" onclick="openOffer()">
    <span id="trigger-text"></span> ğŸ
</div>

<script>
    const userLang = navigator.language.startsWith("he") ? "he" : "ar";
    document.documentElement.lang = userLang;
    document.documentElement.dir = (userLang === "ar") ? "rtl" : "ltr";

    const translations = {
        ar: {
            open: "Ù…ÙØªÙˆØ­ Ø§Ù„Ø¢Ù†", closed: "Ù…ØºÙ„Ù‚ Ø­Ø§Ù„ÙŠØ§Ù‹", wa: "ÙˆØ§ØªØ³Ø§Ø¨", waze: "Waze", 
            enter: "Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ±Ø¹", km: "ÙƒÙ… Ø¨Ø¹ÙŠØ¯", trigger: "Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ…", 
            claim: "Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¢Ù†", msg: "Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£ÙˆØ¯ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ…!"
        },
        he: {
            open: "×¤×ª×•×— ×¢×›×©×™×•", closed: "×¡×’×•×¨ ×›×¢×ª", wa: "×•×•××˜×¡××¤", waze: "× ×™×•×•×˜", 
            enter: "×›× ×™×¡×” ×œ×¡× ×™×£", km: '×§"× ×××š', trigger: "××‘×¦×¢ ×”×™×•×", 
            claim: "×§×‘×œ ××ª ×”××‘×¦×¢ ×¢×›×©×™×•", msg: "×©×œ×•×, ××©××— ×œ×§×‘×œ ××ª ××‘×¦×¢ ×”×™×•×!"
        }
    };

    const t = translations[userLang];
    
    // UI Localization
    document.getElementById('trigger-text').textContent = t.trigger;
    document.getElementById('get-offer-btn').textContent = t.claim;
    document.getElementById('online-btn').href = (userLang === "he") ? "https://madperfume.co.il" : "https://madperfume.ps";

    function isOpen(b) {
        const now = new Date();
        const days = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];
        const today = days[now.getDay()];
        const currentTime = now.getHours() * 60 + now.getMinutes();
        if (!b.schedule || !b.schedule[today]) return false;
        return b.schedule[today].some(r => {
            const [sh, sm] = r[0].split(':').map(Number);
            const [eh, em] = r[1].split(':').map(Number);
            return currentTime >= (sh * 60 + sm) && currentTime < (eh * 60 + em);
        });
    }

    function calcDist(lat1, lon1, lat2, lon2) {
        const R = 6371;
        const dLat = (lat2 - lat1) * Math.PI / 180;
        const dLon = (lon2 - lon1) * Math.PI / 180;
        const a = Math.sin(dLat / 2) ** 2 + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon / 2) ** 2;
        return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    }

    async function loadBranches() {
        try {
            const res = await fetch('test.json');
            const data = await res.json();
            let list = (userLang === "he") ? data.branches.filter(b => !b.is_west_bank) : data.branches;

            render(list);

            navigator.geolocation.getCurrentPosition(pos => {
                const {latitude: uLat, longitude: uLng} = pos.coords;
                list.forEach(b => { if(b.lat) b.dist = calcDist(uLat, uLng, b.lat, b.lng); });
                list.sort((a,b) => a.dist - b.dist);
                render(list);
            });
        } catch(e) { console.error("Load Fail"); }
    }

    function render(list) {
        const container = document.getElementById('branchesList');
        container.innerHTML = '';
        list.forEach(b => {
            const openStatus = isOpen(b);
            const card = document.createElement('div');
            card.className = 'branch-card';
            card.innerHTML = `
                <div class="branch-header">
                    <div class="branch-name-box">
                        <h3>${b[`name_${userLang}`]}</h3>
                        <div class="dist-info">${b.dist ? b.dist.toFixed(1) + ' ' + t.km : ''}</div>
                    </div>
                    <div class="status-pill ${openStatus ? 'open' : 'closed'}">
                        <span class="dot" style="background:${openStatus ? 'var(--wa-green)' : '#ff4d4d'}"></span>
                        ${openStatus ? t.open : t.closed}
                    </div>
                </div>
                <div class="btn-group">
                    <a href="https://wa.me/${b.phone}" class="btn bg-wa"><i class="fab fa-whatsapp"></i>${t.wa}</a>
                    <a href="https://waze.com/ul?ll=${b.lat},${b.lng}&navigate=yes" class="btn bg-waze"><i class="fab fa-waze"></i>${t.waze}</a>
                    <a href="test.html?branch=${b.id}" class="btn bg-enter"><i class="fas fa-door-open"></i>${t.enter}</a>
                </div>
            `;
            container.appendChild(card);
        });
    }

    function openOffer() { document.getElementById('offer-modal').style.display = 'flex'; document.getElementById('offer-trigger').style.display = 'none'; }
    function closeOffer() { document.getElementById('offer-modal').style.display = 'none'; document.getElementById('offer-trigger').style.display = 'flex'; localStorage.setItem('sale_seen', '1'); }

    document.addEventListener('DOMContentLoaded', () => {
        document.body.style.opacity = "1";
        document.getElementById('get-offer-btn').href = `https://wa.me/972509787730?text=${encodeURIComponent(t.msg)}`;
        if(!localStorage.getItem('sale_seen')) setTimeout(openOffer, 2500);
        else document.getElementById('offer-trigger').style.display = 'block';

        setInterval(() => {
            const diff = new Date().setHours(23,59,59) - new Date();
            const h = Math.floor(diff/3600000).toString().padStart(2,'0'), m = Math.floor((diff%3600000)/60000).toString().padStart(2,'0'), s = Math.floor((diff%60000)/1000).toString().padStart(2,'0');
            document.getElementById('modal-timer').textContent = `${h}:${m}:${s}`;
        }, 1000);
        loadBranches();
    });
</script>
</body>
</html>
