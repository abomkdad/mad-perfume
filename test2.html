<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>MAD PARFUMEUR | Shop</title>
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){
n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init','1072283127290819');
fbq('track','PageView');
</script>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Cinzel:wght@700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
/* Ø§Ø³ØªØ®Ø¯Ù… Ù†ÙØ³ Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù‡ÙŠØ¯Ø± ÙˆØ§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ù…Ù† test.html */
:root { --gold: #D4AF37; --card-bg: #141414; --wa-green: #25D366; --sky-blue: #4db8ff; }
body { background: #0a0a0a; color: #fff; font-family: 'Assistant', sans-serif; direction: rtl; }
.main-header { background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.9)), url("https://madparfumeurglobal.com/wp-content/uploads/2025/10/1920x600-BERGAY.jpg") center/cover; padding: 30px 15px; text-align: center; border-bottom: 2px solid var(--gold); }
.logo img { width: 85px; }
.brand-name { font-weight: 900; font-size: 22px; margin: 15px 0 10px; }

/* Product Horizontal Card */
.product-card { background: var(--card-bg); border: 1px solid #333; border-radius: 20px; margin: 15px; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
.card-top { display: flex; justify-content: space-between; align-items: flex-start; }
.product-title { font-family: 'Cinzel'; color: var(--gold); font-size: 1.2rem; }
.img-container { width: 100px; height: 100px; border-radius: 50%; border: 2px solid var(--gold); overflow: hidden; }
.img-container img { width: 100%; height: 100%; object-fit: cover; }
.action-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.btn { padding: 12px; border-radius: 12px; font-weight: 700; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px; color: #fff; }

/* Floating Widget & Modal Same as test.html */
#offer-trigger { position: fixed; bottom: 20px; right: 20px; background: var(--gold); color: #000; padding: 10px 15px; border-radius: 50px; display: none; align-items: center; gap: 8px; font-weight: 900; cursor: pointer; z-index: 999; animation: bounce 2s infinite; }
#offer-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; align-items: center; justify-content: center; z-index: 10000; padding: 20px; }
.modal-content { width: 100%; max-width: 400px; background: #000; border: 2px solid var(--gold); border-radius: 25px; text-align: center; overflow: hidden; position: relative; }
#modal-timer { background: var(--gold); color: #000; padding: 10px; font-weight: 900; font-size: 1.5rem; }
.btn-get-offer { display: block; margin: 15px; background: var(--wa-green); color: #fff; padding: 15px; border-radius: 50px; text-decoration: none; font-weight: 900; }
@keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-10px)} }
</style>
</head>

<body>

<header class="main-header">
  <div class="logo"><img src="https://abomkdad.github.io/Digital-Business-Card/logo.png"></div>
  <h1 class="brand-name">MAD PARFUMEUR ISRAEL</h1>
  <div id="br-title" style="color:var(--gold); font-weight: bold; font-size: 1.4rem;"></div>
</header>

<main id="main-grid"></main>

<div id="offer-modal">
    <div class="modal-content">
        <div id="modal-timer">00:00:00</div>
        <img src="sale.png" style="width:100%">
        <a id="get-offer-btn" href="#" class="btn-get-offer"></a>
        <div onclick="closeOffer()" style="color:#fff; padding:10px; cursor:pointer; opacity:0.7">Ø¥ØºÙ„Ø§Ù‚ / ×¡×’×•×¨</div>
    </div>
</div>
<div id="offer-trigger" onclick="openOffer()"><span id="trigger-text"></span> ğŸ</div>

<script>
const params = new URLSearchParams(window.location.search);
const branchID = parseInt(params.get('branch')) || 1; 
const lang = navigator.language.startsWith("he") ? "he" : "ar";
let STATE = { branch: null, products: [] };

async function start() {
    try {
        const [bj, pc] = await Promise.all([
            fetch('test.json').then(r => r.json()),
            fetch('products.csv').then(r => r.text())
        ]);
        STATE.branch = bj.branches.find(b => b.id === branchID) || bj.branches[0];
        document.getElementById('br-title').textContent = STATE.branch[`name_${lang}`];
        parseCSV(pc); renderProducts(); initOffer();
    } catch (e) {}
}

function parseCSV(text) {
    const lines = text.split('\n');
    for(let i=1; i<lines.length; i++){
        const c = lines[i].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
        if(c[1]) STATE.products.push({ title: c[1].replace(/"/g,''), img: c[4], price: c[10], cat: c[11] });
    }
}

function renderProducts() {
    const grid = document.getElementById('main-grid');
    STATE.products.forEach(p => {
        const card = document.createElement('div'); card.className = 'product-card';
        card.innerHTML = `<div class="card-top"><div><div class="product-title">${p.title}</div><div style="color:var(--gold); margin-top:5px;">${p.price}</div></div>
        <div class="img-container"><img src="${p.img}"></div></div>
        <div class="action-buttons"><a class="btn" style="background:var(--wa-green)" href="https://wa.me/${STATE.branch.phone}?text=${encodeURIComponent(p.title)}"><i class="fab fa-whatsapp"></i> ÙˆØ§ØªØ³Ø§Ø¨</a>
        <a class="btn" style="background:#333" href="#">ØªÙØ§ØµÙŠÙ„</a></div>`;
        grid.appendChild(card);
    });
}

function openOffer() { document.getElementById('offer-modal').style.display = 'flex'; document.getElementById('offer-trigger').style.display = 'none'; }
function closeOffer() { document.getElementById('offer-modal').style.display = 'none'; document.getElementById('offer-trigger').style.display = 'flex'; }

function initOffer() {
    const t = {
        ar: { trigger: "Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ…", offer: "Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¶", msg: "Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£ÙˆØ¯ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ… Ù…Ù† ÙØ±Ø¹ " + STATE.branch.name_ar },
        he: { trigger: "××‘×¦×¢ ×”×™×•×", offer: "×§×‘×œ×ª ×”×”×˜×‘×”", msg: "×©×œ×•×, ××©××— ×œ×§×‘×œ ××ª ××‘×¦×¢ ×”×™×•× ××¡× ×™×£ " + STATE.branch.name_he }
    }[lang];
    document.getElementById('get-offer-btn').textContent = t.offer;
    document.getElementById('get-offer-btn').href = `https://wa.me/${STATE.branch.phone}?text=${encodeURIComponent(t.msg)}`;
    document.getElementById('trigger-text').textContent = t.trigger;
    setTimeout(openOffer, 3000);
    setInterval(() => {
        const diff = new Date().setHours(23,59,59) - new Date();
        const h = Math.floor(diff/3600000).toString().padStart(2,'0'), m = Math.floor((diff%3600000)/60000).toString().padStart(2,'0'), s = Math.floor((diff%60000)/1000).toString().padStart(2,'0');
        document.getElementById('modal-timer').textContent = `${h}:${m}:${s}`;
    }, 1000);
}
start();
</script>
</body>
</html>
