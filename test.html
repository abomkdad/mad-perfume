<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MAD PARFUMEUR</title>

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&family=Heebo:wght@400;600;800&display=swap" rel="stylesheet">

<!-- Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<!-- META PIXEL (â¬…ï¸ Ø§Ù†Ø³Ø® ID ÙÙ‚Ø· Ø¥Ø°Ø§ ØªØºÙŠÙ‘Ø±) -->
<script>
!function(f,b,e,v,n,t,s){
 if(f.fbq)return;
 n=f.fbq=function(){n.callMethod?
 n.callMethod.apply(n,arguments):n.queue.push(arguments)};
 if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
 n.queue=[];t=b.createElement(e);t.async=!0;
 t.src=v;s=b.getElementsByTagName(e)[0];
 s.parentNode.insertBefore(t,s)
}(window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init','1072283127290819');
fbq('track','PageView');
</script>

<!-- TIKTOK PIXEL -->
<script>
!function (w, d, t) {
  w.TiktokAnalyticsObject=t;
  var ttq=w[t]=w[t]||[];
  ttq.methods=["page","track","identify"];
  ttq.setAndDefer=function(t,e){
    t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}
  };
  for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);
  ttq.load=function(e){
    var i="https://analytics.tiktok.com/i18n/pixel/events.js";
    ttq._i=ttq._i||{};ttq._i[e]=[];
    var o=d.createElement("script");
    o.type="text/javascript";o.async=!0;o.src=i+"?sdkid="+e;
    var a=d.getElementsByTagName("script")[0];
    a.parentNode.insertBefore(o,a)
  };
  ttq.load('TT-XXXXXXX'); /* â¬…ï¸ TikTok Pixel ID */
  ttq.page();
}(window, document, 'ttq');
</script>

<style>
:root{
 --bg:#0a0a0a;--gold:#d4af37;--card:#141414;--text:#fff;--muted:#aaa
}
*{box-sizing:border-box}
body{
 margin:0;background:var(--bg);color:var(--text);
 font-family:'Cairo','Heebo',sans-serif;padding-bottom:100px
}
header{
 background:#000;
 padding:35px 15px 25px;
 text-align:center;
 border-bottom:3px solid var(--gold)
}
.logo img{width:80px}
.brand{color:var(--gold);font-weight:800;letter-spacing:2px;margin-top:8px}
.branch-name{font-size:26px;font-weight:800;margin-top:6px}

.status{
 display:inline-flex;gap:6px;
 margin-top:10px;padding:6px 16px;
 border-radius:20px;font-size:13px;font-weight:700
}
.open{color:#25D366;border:1px solid #25D366;background:rgba(37,211,102,.15)}
.closed{color:#ff4444;border:1px solid #ff4444;background:rgba(255,68,68,.15)}

.duty-staff{
 margin:18px auto 10px;
 display:flex;align-items:center;gap:12px;
 border:1px solid var(--gold);
 padding:10px 20px;border-radius:50px;
 width:fit-content;cursor:pointer
}
.staff-img{
 width:55px;height:55px;border-radius:50%;
 border:2px solid var(--gold)
}
.staff-label{font-size:11px;color:var(--gold);font-weight:800}
.staff-name{font-size:15px;font-weight:700}

.socials{
 display:flex;justify-content:center;gap:14px;margin-top:18px
}
.socials a{
 width:44px;height:44px;border-radius:50%;
 border:1px solid var(--gold);
 display:flex;align-items:center;justify-content:center;
 color:var(--gold);font-size:18px;text-decoration:none
}

/* POPUP */
.popup-overlay{
 position:fixed;inset:0;background:rgba(0,0,0,.8);
 display:none;justify-content:center;align-items:center;z-index:9999
}
.popup{
 width:92%;max-width:420px;
 background:#0b0b0b;border:2px solid var(--gold);
 border-radius:18px;padding:12px;position:relative
}
.popup-close{
 position:absolute;top:10px;right:10px;
 background:#000;color:#fff;
 padding:6px 12px;border-radius:12px;
 cursor:pointer;font-size:14px
}
.popup-image{aspect-ratio:1/1;overflow:hidden;border-radius:12px}
.popup-image img{width:100%;height:100%;object-fit:cover}
.popup-cta{
 margin-top:12px;background:#22c55e;
 padding:14px;border-radius:14px;
 text-align:center;font-weight:800;font-size:18px;
 cursor:pointer
}
.timer{margin-top:8px;font-size:13px;color:var(--muted)}
</style>
</head>

<body>

<header>
 <div class="logo"><img src="https://abomkdad.github.io/Digital-Business-Card/logo.png"></div>
 <div class="brand">MAD PARFUMEUR</div>
 <div id="branchName" class="branch-name"></div>
 <div id="branchStatus"></div>

 <div class="duty-staff" id="staffBtn">
  <img src="https://madperfume.ps/upload/01-2026/page/6966930e9af7f.png" class="staff-img">
  <div>
   <div class="staff-label" id="staffLabel"></div>
   <div class="staff-name">Ù…ÙŠØ±Ø§Ù„ / ××™×¨××œ</div>
  </div>
 </div>

 <div class="socials" id="socials"></div>
</header>

<!-- POPUP -->
<div class="popup-overlay" id="popup">
 <div class="popup">
  <div class="popup-close" onclick="closePopup()">âœ• Ø¥ØºÙ„Ø§Ù‚</div>
  <div class="popup-image">
   <img src="sale.png">
  </div>
  <div class="popup-cta" onclick="goToWhatsApp()">ğŸ”¥ Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ…</div>
  <div class="timer" id="timer"></div>
 </div>
</div>

<script>
/* LANGUAGE */
const lang = navigator.language.startsWith("he")?"he":"ar";
document.documentElement.lang=lang;
document.documentElement.dir=lang==="he"?"ltr":"rtl";

const TXT={
 ar:{staff:"Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ù†Ø§ÙˆØ¨",open:"Ù…ÙØªÙˆØ­ Ø§Ù„Ø¢Ù†",closed:"Ù…ØºÙ„Ù‚ Ø§Ù„Ø¢Ù†"},
 he:{staff:"× ×¦×™×’ ×ª×•×¨×Ÿ",open:"×¤×ª×•×— ×¢×›×©×™×•",closed:"×¡×’×•×¨ ×¢×›×©×™×•"}
};

/* TIME */
function minutes(t){const a=t.split(":");return +a[0]*60+ +a[1];}
function isOpenNow(schedule){
 if(!schedule)return false;
 const d=new Date(),days=["sun","mon","tue","wed","thu","fri","sat"];
 const list=schedule[days[d.getDay()]]||[];
 const now=d.getHours()*60+d.getMinutes();
 return list.some(r=>now>=minutes(r[0])&&now<=minutes(r[1]));
}

/* PIXEL */
function lead(name,data){
 if(window.fbq)fbq("track","Lead",{event:name,...data});
 if(window.ttq)ttq.track("SubmitForm",{event:name,...data});
}

/* BRANCH */
const branchID=new URLSearchParams(location.search).get("branch");

fetch("test.json").then(r=>r.json()).then(d=>{
 const b=d.branches.find(x=>String(x.id)===String(branchID));
 if(!b)return;

 document.getElementById("branchName").textContent=
  lang==="he"?b.name_he:b.name_ar;

 const open=isOpenNow(b.schedule);
 document.getElementById("branchStatus").innerHTML=
  `<div class="status ${open?'open':'closed'}">
   ${open?TXT[lang].open:TXT[lang].closed}
  </div>`;

 document.getElementById("staffLabel").textContent=TXT[lang].staff;

 const phone="972"+b.phone.replace(/^0/,"");
 window.goToWhatsApp=()=>{
  lead("WhatsApp",{branch:b.id});
  window.open(`https://wa.me/${phone}`,"_blank");
 };

 document.getElementById("staffBtn").onclick=goToWhatsApp;

 const socials=[
  ["location-dot",b.social.waze],
  ["whatsapp",`https://wa.me/${phone}`],
  ["instagram",b.social.instagram],
  ["tiktok",b.social.tiktok],
  ["facebook-f",b.social.facebook],
  ["envelope",b.social.email?`mailto:${b.social.email}`:null]
 ];

 document.getElementById("socials").innerHTML=
 socials.filter(s=>s[1]).map(s=>`
  <a href="${s[1]}" target="_blank"
   onclick="lead('Social',{branch:${b.id}})">
   <i class="fa-${s[0]==='envelope'?'solid':'brands'} fa-${s[0]}"></i>
  </a>`).join("");

 /* POPUP */
 const today=new Date().toISOString().split("T")[0];
 const key=`popup_${b.id}_${today}`;
 if(!localStorage.getItem(key)){
  document.getElementById("popup").style.display="flex";
 }

 window.closePopup=()=>{
  localStorage.setItem(key,"1");
  document.getElementById("popup").style.display="none";
 };

 function updateTimer(){
  const now=new Date();
  const end=new Date();end.setHours(24,0,0,0);
  const diff=Math.floor((end-now)/1000);
  const h=Math.floor(diff/3600),m=Math.floor(diff%3600/60);
  document.getElementById("timer").textContent=
   (lang==="he"?"× ×’××¨ ×‘×¢×•×“ ":"ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ø¹Ø¯ ")+h+"h "+m+"m";
 }
 updateTimer();setInterval(updateTimer,60000);
});
</script>

</body>
</html>
