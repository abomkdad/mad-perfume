<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>MAD PARFUMEUR | Elite Black Gold Portal</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Assistant:wght@400;700;900&family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window,document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init','1072283127290819');fbq('track','PageView');
</script>

<script>
!function (w,d,t) {
w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];
ttq.methods=["page","track","identify","instances","debug","on","off","once","ready"];
for(var i=0;i<ttq.methods.length;i++){ttq[ttq.methods[i]]=function(a){return function(){ttq.push([a].concat(Array.prototype.slice.call(arguments)))}}(ttq.methods[i]);}
ttq.load=function(e){var n=d.createElement("script");n.async=!0;n.src="https://analytics.tiktok.com/i18n/pixel/events.js?sdkid="+e;
var t=d.getElementsByTagName("script")[0];t.parentNode.insertBefore(n,t)};
ttq.load('D2D02JBC77U4ENLN9SBG');ttq.page();
}(window,document,'ttq');
function trackLead(n){if(window.fbq)fbq('track','Lead',{content_name:n});if(window.ttq)ttq.track('Contact',{content_name:n});}
</script>

<style>
:root{
--bg:#050505;
--card:#0f0f0f;
--gold:#D4AF37;
--soft:#1a1a1a;
--radius:18px;
--shadow:0 10px 25px rgba(0,0,0,.6);
--wa:#25D366;
--danger:#ff2b2b;
--green:#00ff7f;
}

*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
body{
background:var(--bg);
color:#fff;
font-family:'Assistant','Cairo',sans-serif;
overflow-x:hidden;
padding-bottom:140px;
}

/* TOP BAR */
.top-wa-bar{
background:var(--wa);
color:#000;
font-weight:900;
text-align:center;
padding:12px;
display:flex;
align-items:center;
justify-content:center;
gap:8px;
position:sticky;
top:0;
z-index:9999;
text-decoration:none;
}

/* HEADER */
header{
text-align:center;
padding:25px 15px;
background:linear-gradient(rgba(0,0,0,.85),#000),
url('https://madparfumeurglobal.com/wp-content/uploads/2025/10/1920x600-BERGAY.jpg') center/cover;
border-bottom:2px solid var(--gold);
}

.logo-img{width:120px;margin-bottom:12px}

.staff-wrapper{width:90px;height:90px;margin:0 auto 10px;position:relative}
.staff-img{width:100%;height:100%;border-radius:50%;border:3px solid var(--gold);object-fit:cover}
.status-dot{
position:absolute;bottom:5px;right:5px;width:18px;height:18px;
border-radius:50%;border:3px solid #000;animation:pulse 1.5s infinite;
}
@keyframes pulse{
0%{box-shadow:0 0 0 0 rgba(255,255,255,.4)}
70%{box-shadow:0 0 0 12px rgba(255,255,255,0)}
100%{box-shadow:0 0 0 0 rgba(255,255,255,0)}
}

.branch-title{
font-family:'Cinzel';
color:var(--gold);
font-size:1.6rem;
font-weight:900;
}

.open-status-text{font-weight:900;margin-top:5px}

.social-icons{
display:flex;
justify-content:center;
gap:14px;
margin-top:15px
}
.social-icons a{
width:42px;height:42px;
border-radius:50%;
background:rgba(255,255,255,.1);
border:1px solid rgba(255,255,255,.2);
display:flex;align-items:center;justify-content:center;
color:#fff;
}

/* CATEGORIES */
.cats-wrapper{
position:sticky;
top:48px;
background:#080808;
border-bottom:1px solid #222;
z-index:500;
}
.cats-container{
display:flex;
gap:10px;
overflow-x:auto;
padding:12px;
}
.cat-pill{
display:flex;
align-items:center;
gap:8px;
background:#151515;
border:1px solid #222;
padding:6px 14px;
border-radius:50px;
white-space:nowrap;
cursor:pointer;
}
.cat-pill.active{
background:var(--gold);
color:#000;
}

/* GRID */
.shop-grid{
display:grid;
grid-template-columns:repeat(2,1fr);
gap:12px;
padding:12px;
}

.p-card{
background:var(--card);
border-radius:var(--radius);
overflow:hidden;
border:1px solid #1f1f1f;
display:flex;
flex-direction:column;
box-shadow:var(--shadow);
}

.p-card img{
width:100%;
aspect-ratio:1/1;
object-fit:cover;
}

.p-info{
padding:10px;
display:flex;
flex-direction:column;
justify-content:space-between;
flex:1;
text-align:center;
}

.add-btn{
background:var(--gold);
color:#000;
border:none;
padding:10px;
border-radius:12px;
font-weight:900;
margin-top:8px;
cursor:pointer;
}

.add-btn.added{
background:#222;
color:#fff;
}

/* FLOATING CART */
#cart-fab{
position:fixed;
bottom:90px;
right:20px;
width:62px;height:62px;
border-radius:50%;
background:var(--gold);
display:flex;
align-items:center;
justify-content:center;
z-index:999;
box-shadow:var(--shadow);
}

#cart-count{
position:absolute;
top:-5px;right:-5px;
background:var(--danger);
color:#fff;
width:22px;height:22px;
border-radius:50%;
font-size:12px;
font-weight:900;
display:flex;
align-items:center;
justify-content:center;
border:2px solid #000;
}

/* DRAWER */
.drawer{
position:fixed;
bottom:-100%;
left:0;
width:100%;
height:80%;
background:#0b0b0b;
border-top:3px solid var(--gold);
border-radius:22px 22px 0 0;
padding:20px;
z-index:10000;
transition:.4s;
display:flex;
flex-direction:column;
}
.drawer.open{bottom:0}

.checkout-btn{
background:var(--wa);
border:none;
padding:18px;
border-radius:14px;
font-weight:900;
font-size:1.1rem;
margin-top:15px;
color:#000;
}

/* FOOTER */
.frag-footer{
position:fixed;
bottom:0;
left:0;
width:100%;
background:#0d0d0d;
border-top:2px solid var(--gold);
padding:12px 16px;
display:flex;
justify-content:space-between;
align-items:center;
z-index:999;
}

.frag-btn{
background:var(--gold);
border:none;
border-radius:20px;
padding:8px 18px;
font-weight:900;
}

/* MODALS */
.modal-overlay{
position:fixed;
inset:0;
background:rgba(0,0,0,.9);
display:none;
align-items:center;
justify-content:center;
z-index:20000;
}
</style>
</head>

<body>

<a id="top-wa-btn" class="top-wa-bar" target="_blank" onclick="trackLead('Top Bar')">
<i class="fab fa-whatsapp"></i><span id="top-wa-txt"></span>
</a>

<header>
<img src="logo.png" class="logo-img">
<div class="staff-wrapper">
<img src="https://madperfume.ps/upload/01-2026/page/6966930e9af7f.png" class="staff-img">
<div id="status-dot" class="status-dot"></div>
</div>
<div id="br-name" class="branch-title"></div>
<div id="open-status-display" class="open-status-text"></div>
<div id="br-social" class="social-icons"></div>
</header>

<div class="cats-wrapper">
<div id="cats-box" class="cats-container"></div>
</div>

<main id="main-grid" class="shop-grid"></main>

<div id="cart-fab" onclick="toggleCart(true)">
<i class="fas fa-shopping-bag" style="color:#000;font-size:22px"></i>
<div id="cart-count">0</div>
</div>

<div id="cart-drawer" class="drawer">
<h2 id="cart-title" style="text-align:center;color:var(--gold);font-family:'Cinzel'"></h2>
<div id="cart-list" style="flex:1;overflow:auto"></div>
<div id="cart-total" style="text-align:center;font-weight:900;color:var(--gold);font-size:1.5rem;margin-top:10px"></div>
<button class="checkout-btn" onclick="sendOrder()">
<i class="fab fa-whatsapp"></i> <span id="check-txt"></span>
</button>
</div>

<div id="overlay" style="position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;z-index:9999" onclick="toggleCart(false)"></div>

<script>
const params=new URLSearchParams(location.search);
const branchID=parseInt(params.get('branch'))||1;
const lang=navigator.language.startsWith('ar')?'ar':'he';

const TXT={
ar:{all:'الكل',add:'إضافة للسلة',added:'في السلة',total:'المجموع:',check:'إرسال الطلب عبر واتساب',
open:'مفتوح الآن',closed:'مغلق حالياً',prefix:'فرع ',wa_top:'تواصل معنا عبر واتساب',cart:'سلة المشتريات'},
he:{all:'הכל',add:'הוסף לסל',added:'בסל',total:'סה"כ:',check:'שליחת הזמנה בוואטסאפ',
open:'פתוח עכשיו',closed:'סגור כעת',prefix:'סניף ',wa_top:'דברו איתנו בוואטסאפ',cart:'סל קניות'}
};

let STATE={branch:null,products:[],cart:[]};

async function init(){
const [bj,pc]=await Promise.all([
fetch('branches.json').then(r=>r.json()),
fetch('products.csv').then(r=>r.text())
]);
STATE.branch=bj.branches.find(b=>b.id===branchID)||bj.branches[0];
parseProducts(pc);
renderHeader();
renderCats();
renderGrid('all');
}

function parseProducts(csv){
const rows=csv.split('\n');
const catIdx=lang==='ar'?11:10;
for(let i=1;i<rows.length;i++){
const c=rows[i].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
if(!c[0])continue;
STATE.products.push({
id:i,
title:c[0].replace(/"/g,'').trim(),
img:c[3]||'logo.png',
price:parseFloat(c[9])||0,
priceStr:(c[9]||'0')+' ₪',
cat:c[catIdx]||''
});
}
}

function renderHeader(){
const b=STATE.branch,t=TXT[lang];
document.getElementById('br-name').textContent=t.prefix+(lang==='ar'?b.name_ar:b.name_he);
document.getElementById('top-wa-txt').textContent=t.wa_top;
document.getElementById('top-wa-btn').href=`https://wa.me/972${b.phone.substring(1)}`;
document.getElementById('cart-title').textContent=t.cart;
document.getElementById('check-txt').textContent=t.check;

const soc=document.getElementById('br-social');
const icons={instagram:'fa-instagram',facebook:'fa-facebook',tiktok:'fa-tiktok'};
Object.entries(b.social||{}).forEach(([k,v])=>{
if(v&&icons[k])soc.innerHTML+=`<a href="${v}" target="_blank"><i class="fa-brands ${icons[k]}"></i></a>`;
});
}

function renderCats(){
const cats=[...new Set(STATE.products.map(p=>p.cat))].filter(Boolean);
const box=document.getElementById('cats-box');
box.innerHTML=`<div class="cat-pill active" onclick="filterCats(this,'all')">${TXT[lang].all}</div>`;
cats.forEach(c=>{
box.innerHTML+=`<div class="cat-pill" onclick="filterCats(this,'${c}')">${c}</div>`;
});
}

function filterCats(el,name){
document.querySelectorAll('.cat-pill').forEach(p=>p.classList.remove('active'));
el.classList.add('active');
renderGrid(name);
}

function renderGrid(filter){
const grid=document.getElementById('main-grid');
grid.innerHTML='';
const list=filter==='all'?STATE.products:STATE.products.filter(p=>p.cat===filter);
list.forEach(p=>{
const inCart=STATE.cart.some(i=>i.id===p.id);
grid.innerHTML+=`
<div class="p-card">
<img src="${p.img}">
<div class="p-info">
<div>
<div style="font-size:.85rem;font-weight:700">${p.title}</div>
<div style="color:var(--gold);font-weight:900;margin:5px 0">${p.priceStr}</div>
</div>
<button class="add-btn ${inCart?'added':''}" onclick="addToCart(${p.id},this)">
${inCart?TXT[lang].added:TXT[lang].add}
</button>
</div>
</div>`;
});
}

function addToCart(id,btn){
if(STATE.cart.some(i=>i.id===id))return;
STATE.cart.push(STATE.products.find(p=>p.id===id));
btn.classList.add('added');
btn.textContent=TXT[lang].added;
updateCart();
}

function updateCart(){
document.getElementById('cart-count').textContent=STATE.cart.length;
let total=0;
const list=document.getElementById('cart-list');
list.innerHTML='';
STATE.cart.forEach(i=>{
total+=i.price;
list.innerHTML+=`
<div style="display:flex;gap:10px;padding:10px;border-bottom:1px solid #222">
<img src="${i.img}" style="width:45px;border-radius:8px">
<div style="flex:1">${i.title}</div>
<div style="color:var(--gold)">${i.priceStr}</div>
</div>`;
});
document.getElementById('cart-total').textContent=TXT[lang].total+' '+total+' ₪';
}

function toggleCart(s){
document.getElementById('cart-drawer').classList.toggle('open',s);
document.getElementById('overlay').style.display=s?'block':'none';
}

function sendOrder(){
let msg=TXT[lang].check+':\n';
STATE.cart.forEach((i,idx)=>msg+=`${idx+1}. ${i.title}\n`);
trackLead('Checkout');
window.open(`https://wa.me/972${STATE.branch.phone.substring(1)}?text=${encodeURIComponent(msg)}`,'_blank');
}

init();
</script>

</body>
</html>
