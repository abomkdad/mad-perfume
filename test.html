<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MAD PARFUMEUR | Official Portal</title>

    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;700;800&family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --gold: #d4af37;
            --dark-bg: #0a0a0a;
            --card-bg: #161616;
            --wa-green: #25D366;
            --waze-blue: #33CCFF;
            --text-main: #ffffff;
            --btn-gray: #333333;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background-color: var(--dark-bg); color: var(--text-main); font-family: 'Assistant', 'Cairo', sans-serif; direction: rtl; opacity: 0; transition: opacity 0.5s; padding-bottom: 40px; }

        header {
            background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.9)), 
                        url('https://madparfumeurglobal.com/wp-content/uploads/2025/10/1920x600-BERGAY.jpg') center/cover;
            padding: 30px 15px 60px; text-align: center; border-bottom: 2px solid var(--gold);
        }
        .logo img { width: 80px; margin-bottom: 10px; }
        .brand-name { font-size: 22px; font-weight: 900; margin-bottom: 20px; letter-spacing: 1px; }

        /* Action Grid */
        .action-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; max-width: 650px; margin: 0 auto; }
        .action-item {
            background: var(--btn-gray); border: 2px solid rgba(212,175,55,0.4);
            padding: 15px 5px; border-radius: 15px; text-decoration: none; color: white;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .action-item i { font-size: 20px; color: var(--gold); margin-bottom: 6px; }
        .action-item span { font-size: 13px; font-weight: 900; }
        .action-item .hotline { font-size: 11px; color: var(--gold); margin-top: 4px; }

        .container { max-width: 800px; margin: -35px auto 30px; padding: 0 15px; }
        
        /* Branches */
        .branch-card {
            background: var(--card-bg); border-radius: 20px; padding: 20px;
            margin-bottom: 15px; border-right: 5px solid var(--gold);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .br-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .br-title { font-size: 18px; font-weight: 800; color: var(--gold); }
        .status-pill { font-size: 11px; padding: 4px 10px; border-radius: 25px; border: 1px solid; }

        .btn-group { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
        .btn { padding: 10px 5px; border-radius: 10px; text-decoration: none; color: white; font-weight: 800; font-size: 11px; text-align: center; display: flex; flex-direction: column; align-items: center; gap: 4px; }
        .bg-wa { background: var(--wa-green); }
        .bg-waze { background: var(--waze-blue); color: #000; }
        .bg-enter { background: var(--btn-gray); }

        /* --- TRUST SECTION (NEW) --- */
        .trust-anchor {
            max-width: 800px; margin: 20px auto; padding: 20px;
            background: linear-gradient(145deg, #1a1a1a, #111);
            border-radius: 20px; border: 1px dashed var(--gold);
            text-align: center; cursor: pointer; transition: transform 0.3s;
        }
        .trust-anchor:hover { transform: scale(1.02); }
        .trust-anchor img { height: 40px; margin-bottom: 10px; }
        .stars { color: var(--gold); font-size: 20px; margin-bottom: 5px; }
        .trust-text { font-size: 14px; font-weight: 700; color: #eee; }

        /* --- FULL SCREEN MODAL --- */
        #gateway-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 10000; flex-direction: column; align-items: center; justify-content: center;
            padding: 30px; text-align: center;
        }

        .modal-close-btn {
            position: absolute; top: 20px;
            background: var(--gold); color: #000; padding: 8px 20px;
            border-radius: 30px; font-weight: 900; font-size: 14px;
            cursor: pointer; border: none;
        }
        /* Positioning close btn based on language */
        html[dir="rtl"] .modal-close-btn { right: 20px; }
        html[dir="ltr"] .modal-close-btn { left: 20px; }

        .modal-content { max-width: 500px; width: 100%; }
        .modal-content img.main-logo { height: 100px; margin-bottom: 20px; }
        .modal-content h2 { color: var(--gold); font-size: 28px; margin-bottom: 15px; font-weight: 900; }
        .modal-content p { font-size: 18px; line-height: 1.6; margin-bottom: 30px; color: #ccc; }
        
        .huge-btn {
            display: block; width: 100%; padding: 20px; background: var(--gold);
            color: #000; border-radius: 15px; text-decoration: none;
            font-weight: 900; font-size: 20px; transition: 0.3s;
        }

        /* --- STICKY POPUP --- */
        .sticky-fragrantica {
            position: fixed; bottom: 20px; left: 20px; right: 20px;
            max-width: 400px; margin: 0 auto; background: #111;
            border: 2px solid var(--gold); padding: 15px; display: flex;
            justify-content: space-between; align-items: center; z-index: 999;
            border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.8);
            transform: translateY(200%); transition: transform 0.5s ease-out;
        }
        .sticky-fragrantica.show { transform: translateY(0); }
        .close-mini { cursor: pointer; color: var(--gold); font-weight: bold; margin-left: 10px; }
    </style>
</head>
<body>

<header>
    <div class="logo"><img src="https://abomkdad.github.io/Digital-Business-Card/logo.png"></div>
    <div class="brand-name">MAD PARFUMEUR ISRAEL</div>
    
    <div class="action-grid">
        <a href="tel:*9935" class="action-item">
            <i class="fas fa-phone-alt"></i>
            <span id="txt-cs"></span>
            <div class="hotline">*9935</div>
        </a>
        <a id="wa-corp-btn" href="#" class="action-item">
            <i class="fab fa-whatsapp"></i>
            <span id="txt-wa"></span>
            <div class="hotline">050-978-7730</div>
        </a>
        <a id="online-btn" href="#" class="action-item">
            <i class="fas fa-shopping-bag"></i>
            <span id="txt-shop"></span>
            <div class="hotline">Shop Now</div>
        </a>
    </div>
</header>

<div class="container">
    <div id="branchesList">...</div>
    
    <div class="trust-anchor" onclick="toggleModal(true)">
        <img src="https://www.fragrantica.com/favicon.ico" alt="Fragrantica">
        <div class="stars">★★★★★</div>
        <div class="trust-text" id="txt-trust-anchor"></div>
    </div>
</div>

<div id="gateway-modal">
    <button class="modal-close-btn" id="txt-close" onclick="toggleModal(false)"></button>
    
    <div class="modal-content">
        <img src="https://abomkdad.github.io/Digital-Business-Card/logo.png" class="main-logo">
        <h2 id="modal-title"></h2>
        <p id="modal-desc"></p>
        <div class="stars" style="font-size: 40px; margin-bottom: 30px;">★★★★★</div>
        <a href="#" class="huge-btn" id="modal-btn" onclick="openFragrantica()"></a>
    </div>
</div>

<div class="sticky-fragrantica" id="miniPopup">
    <div class="close-mini" onclick="closeMini()">✕</div>
    <div style="text-align:right; flex:1">
        <h5 id="mini-title" style="color:var(--gold)"></h5>
    </div>
    <button class="btn bg-wa" style="padding: 5px 15px; font-size:10px" onclick="toggleModal(true)" id="mini-btn"></button>
</div>

<script>
    // Language Setup
    const userLang = navigator.language.startsWith("he") ? "he" : "ar";
    document.documentElement.lang = userLang;
    document.documentElement.dir = "rtl"; // Both are RTL

    const translations = {
        ar: {
            cs: "خدمة الزبائن", wa: "واتساب الشركة", shop: "الطلب أونلاين",
            trust_anchor: "MAD: الأعلى تقييماً في موسوعة Fragrantica العالمية",
            modal_title: "عطور أصلية بمقاييس عالمية",
            modal_desc: "اكتشف لماذا تُعد MAD أكبر دار عطور نيش حاصلة على تقييمات 5 نجوم في موسوعة Fragrantica. نحن نضمن لك الفخامة والجودة الأصلية.",
            modal_btn: "استكشف التقييمات الآن",
            close: "إغلاق",
            mini_title: "لماذا نحن الأفضل عالمياً؟",
            mini_btn: "اكتشف",
            open: "مفتوح الآن", closed: "مغلق حالياً", enter: "دخول الفرع", wa_btn: "واتساب"
        },
        he: {
            cs: "שירות לקוחות", wa: "וואטسאפ חברה", shop: "הזמנה אונליין",
            trust_anchor: "MAD: המדורגת ביותר באנציקלופדיית Fragrantica",
            modal_title: "בשמים מקוריים בסטנדרט עולמי",
            modal_desc: "גלו מדוע MAD היא חברת בשמי הניش הגדולה בעולם עם דירוגי 5 כוכבים ב-Fragrantica. חוויה של יוקרה ואיכות מקורית.",
            modal_btn: "לצפייה בדירוגים העולמיين",
            close: "סגור",
            mini_title: "למה אנחנו המדורגים ביותר בעולם?",
            mini_btn: "גלה עכשיו",
            open: "פתוح עכשיו", closed: "סגור כעת", enter: "כניסה לסניף", wa_btn: "וואטסאפ"
        }
    }[userLang];

    // Apply Translations
    document.getElementById('txt-cs').textContent = translations.cs;
    document.getElementById('txt-wa').textContent = translations.wa;
    document.getElementById('txt-shop').textContent = translations.shop;
    document.getElementById('txt-trust-anchor').textContent = translations.trust_anchor;
    document.getElementById('modal-title').textContent = translations.modal_title;
    document.getElementById('modal-desc').textContent = translations.modal_desc;
    document.getElementById('modal-btn').textContent = translations.modal_btn;
    document.getElementById('txt-close').textContent = translations.close;
    document.getElementById('mini-title').textContent = translations.mini_title;
    document.getElementById('mini-btn').textContent = translations.mini_btn;

    // Modal & Popup Logic
    function toggleModal(show) {
        const m = document.getElementById('gateway-modal');
        m.style.display = show ? 'flex' : 'none';
        document.body.style.overflow = show ? 'hidden' : 'auto';
        if(show) closeMini();
    }

    function closeMini() { document.getElementById('miniPopup').classList.remove('show'); }

    function openFragrantica() {
        const url = (userLang === "he") 
            ? "https://www.fragrantica.co.il/designers/Mad-Parfumeur.html" 
            : "https://www.fragranticarabia.com/designers/Mad-Parfumeur.html";
        window.open(url, '_blank');
    }

    // WhatsApp Builder
    function buildWaUrl(phone) {
        let p = phone.replace(/\D/g, ''); 
        if (p.startsWith('0')) p = '972' + p.substring(1);
        return `https://api.whatsapp.com/send/?phone=${p}`;
    }
    document.getElementById('wa-corp-btn').href = buildWaUrl('0509787730');
    document.getElementById('online-btn').href = (userLang === "he") ? "https://madperfume.co.il" : "https://madperfume.ps";

    // Branch Logic
    function isBranchOpen(b) {
        const now = new Date();
        const days = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];
        const today = days[now.getDay()];
        const currentTime = now.getHours() * 60 + now.getMinutes();
        if (!b.schedule || !b.schedule[today]) return false;
        return b.schedule[today].some(r => {
            const [sH, sM] = r[0].split(':').map(Number);
            const [eH, eM] = r[1].split(':').map(Number);
            return currentTime >= (sH * 60 + sM) && currentTime < (eH * 60 + eM);
        });
    }

    async function init() {
        try {
            const res = await fetch('branches.json?v=' + Date.now());
            const data = await res.json();
            const container = document.getElementById('branchesList');
            container.innerHTML = '';
            data.branches.forEach(b => {
                const open = isBranchOpen(b);
                const card = document.createElement('div');
                card.className = 'branch-card';
                card.innerHTML = `
                    <div class="br-header">
                        <div class="br-title">${b[`name_${userLang}`]}</div>
                        <div class="status-pill" style="border-color:${open ? 'var(--wa-green)' : '#ff4d4d'}; color:${open ? 'var(--wa-green)' : '#ff4d4d'}">
                            ● ${open ? translations.open : translations.closed}
                        </div>
                    </div>
                    <div class="btn-group">
                        <a href="${buildWaUrl(b.phone)}" class="btn bg-wa"><i class="fab fa-whatsapp"></i>${translations.wa_btn}</a>
                        <a href="https://ul.waze.com/ul?ll=${b.lat},${b.lng}&navigate=yes" target="_blank" class="btn bg-waze"><i class="fab fa-waze"></i>Waze</a>
                        <a href="offer.html?branch=${b.id}" class="btn bg-enter"><i class="fas fa-gift"></i>${translations.enter}</a>
                    </div>`;
                container.appendChild(card);
            });
            document.body.style.opacity = "1";
            setTimeout(() => document.getElementById('miniPopup').classList.add('show'), 2500);
        } catch(e) { console.error(e); }
    }
    init();
</script>
</body>
</html>
