<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MAD PARFUMEUR</title>

<!-- ===================== FONTS & ICONS ===================== -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&family=Heebo:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<!-- ========================================================= -->
<!-- ðŸ”´ META PIXEL â€“ COPY HERE ðŸ”´ -->
<!-- ========================================================= -->
<script>
!function(f,b,e,v,n,t,s){
 if(f.fbq)return;
 n=f.fbq=function(){n.callMethod?
 n.callMethod.apply(n,arguments):n.queue.push(arguments)};
 if(!f._fbq)f._fbq=n;
 n.push=n;n.loaded=!0;n.version='2.0';
 n.queue=[];
 t=b.createElement(e);t.async=!0;
 t.src=v;
 s=b.getElementsByTagName(e)[0];
 s.parentNode.insertBefore(t,s)
}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');

/* ðŸ”´ PUT META PIXEL ID HERE ðŸ”´ */
fbq('init','META_PIXEL_ID_HERE');
fbq('track','PageView');
</script>

<!-- ========================================================= -->
<!-- ðŸ”´ TIKTOK PIXEL â€“ COPY HERE ðŸ”´ -->
<!-- ========================================================= -->
<script>
!function (w, d, t) {
  w.TiktokAnalyticsObject = t;
  var ttq = w[t] = w[t] || [];
  ttq.methods = [
    "page","track","identify","instances","debug","on","off","once","ready",
    "alias","group","enableCookie","disableCookie"
  ];
  ttq.setAndDefer = function (t, e) {
    t[e] = function () {
      t.push([e].concat(Array.prototype.slice.call(arguments, 0)));
    };
  };
  for (var i = 0; i < ttq.methods.length; i++) {
    ttq.setAndDefer(ttq, ttq.methods[i]);
  }
  ttq.load = function (e) {
    var s = document.createElement("script");
    s.async = true;
    s.src = "https://analytics.tiktok.com/i18n/pixel/events.js?sdkid=" + e;
    document.head.appendChild(s);
  };

  /* ðŸ”´ PUT TIKTOK PIXEL ID HERE ðŸ”´ */
  ttq.load('TIKTOK_PIXEL_ID_HERE');
  ttq.page();
}(window, document, 'ttq');
</script>

<!-- ===================== STYLE ===================== -->
<style>
:root{--bg:#0a0a0a;--gold:#d4af37;--text:#fff}
body{margin:0;background:var(--bg);color:var(--text);font-family:Cairo,Heebo}
header{text-align:center;padding:40px 15px;border-bottom:3px solid var(--gold)}
.logo{width:80px;margin:auto}
.logo img{width:100%}
.products{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:15px;padding:15px}
.card{background:#141414;border-radius:16px;padding:12px;text-align:center}
.card img{width:100%;border-radius:12px}
.btn{background:#25D366;color:#fff;padding:10px;border-radius:8px;text-decoration:none;display:block;margin-top:10px}
.popup-overlay{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:999}
.popup{width:90%;max-width:420px;background:#000;border:2px solid var(--gold);border-radius:18px;padding:12px}
.popup img{width:100%;border-radius:12px}
.popup-cta{margin-top:12px;background:#22c55e;color:#000;font-weight:800;padding:14px;border-radius:14px;text-align:center;cursor:pointer}
</style>
</head>

<body>

<header>
  <div class="logo">
    <img src="https://abomkdad.github.io/Digital-Business-Card/logo.png">
  </div>
  <h2>MAD PARFUMEUR</h2>
</header>

<div class="products" id="products"></div>

<!-- ===================== POPUP ===================== -->
<div class="popup-overlay" id="popup">
  <div class="popup">
    <img src="sale.png" alt="Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ…">
    <div class="popup-cta" id="popupBtn">ðŸ”¥ Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ…</div>
  </div>
</div>

<!-- ===================== SCRIPT ===================== -->
<script>
/* ===================================================
   ðŸ”¥ EVENT LAYER â€“ Ù„Ø§ ØªÙ„Ù…Ø³Ù‡ Ø¨Ø¹Ø¯ Ø§Ù„ÙŠÙˆÙ…
=================================================== */
function trackEvent(eventName, data={}){

  /* META */
  if(window.fbq){
    if(eventName==="Lead") fbq("track","Lead",data);
    else if(eventName==="ViewContent") fbq("track","ViewContent",data);
    else fbq("trackCustom",eventName,data);
  }

  /* TIKTOK */
  if(window.ttq){
    if(eventName==="Lead") ttq.track("SubmitForm",data);
    else if(eventName==="ViewContent") ttq.track("ViewContent",data);
    else ttq.track(eventName,data);
  }

  console.log("ðŸ“Š Event:",eventName,data);
}

/* ===================== DATA ===================== */
const params=new URLSearchParams(location.search);
const branchID=params.get("branch")||"general";
let phone="972549634449";

/* ===================== PRODUCTS ===================== */
Papa.parse("products.csv",{
 download:true,header:true,
 complete:r=>{
  r.data.forEach(p=>{
   if(!p.Title)return;
   document.getElementById("products").innerHTML+=`
   <div class="card">
    <img src="${p.Image}">
    <div>${p.Title}</div>
    <div>${p.Price}</div>
    <a class="btn" href="https://wa.me/${phone}?text=${encodeURIComponent(p.Title)}"
     target="_blank"
     onclick="trackEvent('Lead',{source:'product',branch:'${branchID}'})">
     ÙˆØ§ØªØ³Ø§Ø¨
    </a>
   </div>`;
  });
 }
});

/* ===================== POPUP ===================== */
setTimeout(()=>{
 document.getElementById("popup").style.display="flex";

 trackEvent("ViewContent",{
  content_name:"Daily Offer",
  branch:branchID
 });

 document.getElementById("popupBtn").onclick=()=>{
  trackEvent("Lead",{source:"popup_offer",branch:branchID});
  window.open(`https://wa.me/${phone}`,"_blank");
 };
},1000);
</script>

</body>
</html>
