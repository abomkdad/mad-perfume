<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MAD PARFUMEUR | Official Portal</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init','1072283127290819'); fbq('track','PageView');
    </script>
    <script>
    !function (w, d, t) {
      w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var r="https://analytics.tiktok.com/i18n/pixel/events.js",o=n&&n.partner;ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=r,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=r+"?sdkid="+e+"&lib="+t;e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)};
      ttq.load('D2D02JBC77U4ENLN9SBG'); ttq.page();
    }(window, document, 'ttq');
    </script>
    
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;700;800&family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --gold: #D4AF37;
            --white-bg: #ffffff;
            --light-gray: #f8f9fa;
            --wa-green: #25D366;
            --waze-blue: #33CCFF;
            --text-dark: #1a1a1a;
            --gold-gradient: linear-gradient(135deg, #D4AF37, #B08D2B);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background-color: var(--white-bg); color: var(--text-dark); font-family: 'Assistant', 'Cairo', sans-serif; direction: rtl; padding-bottom: 100px; }

        header {
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.8)), 
                        url('https://madparfumeurglobal.com/wp-content/uploads/2025/10/1920x600-BERGAY.jpg') center/cover;
            padding: 40px 15px 70px; text-align: center; border-bottom: 3px solid var(--gold);
        }
        .logo img { width: 90px; filter: drop-shadow(0 0 8px var(--gold)); }
        .brand-name { font-size: 22px; font-weight: 900; margin: 15px 0 25px; color: #fff; letter-spacing: 1px; }

        .social-bar { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; }
        .social-bar a {
            color: #fff; font-size: 15px; width: 38px; height: 38px;
            background: rgba(255,255,255,0.1); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: 1px solid var(--gold); text-decoration: none;
        }

        .action-grid {
            display: grid; grid-template-columns: 1fr 1fr;
            gap: 10px; max-width: 500px; margin: 0 auto;
        }

        .action-item {
            background: #fff; border: 1.5px solid #eee;
            padding: 15px 5px; border-radius: 18px; text-decoration: none; color: var(--text-dark);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .action-item i { font-size: 22px; color: var(--gold); margin-bottom: 6px; }
        .action-item span { font-size: 13px; font-weight: 800; }
        .action-item .hotline { font-size: 16px; color: var(--gold); font-weight: 900; margin-top: 2px; }

        /* تذكرة خاصة لزر الوكيل الجديد */
        .agent-special { border: 1.5px solid var(--gold); background: #fffcf0; }

        .container { max-width: 800px; margin: -35px auto 50px; padding: 0 15px; }
        
        .branch-card {
            background: #fff; border-radius: 22px; padding: 25px;
            margin-bottom: 20px; border: 1px solid #eee;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            border-right: 6px solid var(--gold);
        }
        .br-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .br-title { font-size: 19px; font-weight: 800; color: #000; }
        .status-pill { font-size: 11px; padding: 5px 12px; border-radius: 50px; font-weight: 800; display: flex; align-items: center; gap: 5px; }

        .btn-group { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
        .btn {
            padding: 14px 5px; border-radius: 14px; text-decoration: none; color: white;
            font-weight: 800; font-size: 12px; text-align: center;
            display: flex; flex-direction: column; align-items: center; gap: 5px;
        }
        .bg-wa { background: var(--wa-green); }
        .bg-waze { background: var(--waze-blue); color: #000; }
        .bg-enter { background: #000; color: var(--gold); border: 1px solid var(--gold); }

        .sticky-fragrantica {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: #fff; border-top: 2px solid var(--gold);
            padding: 15px 20px; display: flex; justify-content: space-between;
            align-items: center; z-index: 1000; box-shadow: 0 -5px 15px rgba(0,0,0,0.05);
        }
        .sticky-fragrantica h5 { color: var(--gold); font-size: 15px; font-weight: 900; }
        .sticky-fragrantica p { font-size: 11px; color: #666; }
        .open-frag-btn { background: var(--gold); color: #fff; padding: 10px 22px; border-radius: 50px; font-weight: 900; border: none; cursor: pointer; }

        #gateway-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 10000; align-items: center; justify-content: center;
        }
        .gateway-card {
            background: #fff; width: 92%; max-width: 400px;
            padding: 40px 25px; border-radius: 35px; text-align: center;
        }
        .gateway-stars { color: var(--gold); font-size: 24px; margin-bottom: 20px; }
        .gateway-btn {
            display: block; width: 100%; padding: 16px; border-radius: 18px;
            text-decoration: none; font-weight: 900; font-size: 17px;
            margin-bottom: 12px; border: none; cursor: pointer;
        }
        .btn-enter-modal { background: #000; color: var(--gold); }
    </style>
</head>
<body>

<header>
    <div class="logo"><img src="https://abomkdad.github.io/Digital-Business-Card/logo.png" fetchpriority="high"></div>
    <div class="brand-name">MAD PARFUMEUR ISRAEL</div>

    <div class="social-bar">
        <a href="https://www.facebook.com/MADPARFUMEURISRAEL/"><i class="fab fa-facebook-f"></i></a>
        <a href="https://www.instagram.com/perfume.mad/"><i class="fab fa-instagram"></i></a>
        <a href="https://www.tiktok.com/@mad.perfume"><i class="fab fa-tiktok"></i></a>
        <a href="https://snapchat.com/t/jbtN32Xe"><i class="fab fa-snapchat"></i></a>
    </div>

    <div class="action-grid">
        <a href="tel:*9935" class="action-item">
            <i class="fas fa-phone-alt"></i>
            <span class="l-cs"></span>
            <div class="hotline">*9935</div>
        </a>
        <a id="wa-corp-btn" href="#" class="action-item">
            <i class="fab fa-whatsapp"></i>
            <span class="l-wa"></span>
            <div class="hotline" style="font-size:12px">MAD Official</div>
        </a>
        <a id="online-btn" href="#" class="action-item">
            <i class="fas fa-shopping-bag"></i>
            <span class="l-shop"></span>
            <div class="hotline" style="font-size:12px">Online Shop</div>
        </a>
        <a id="new-agent-btn" href="#" class="action-item agent-special">
            <i class="fas fa-handshake"></i>
            <span class="l-agent"></span>
            <div class="hotline" style="font-size:12px">Join Us</div>
        </a>
    </div>
</header>

<div class="container">
    <div id="branchesList"></div>
</div>

<div class="sticky-fragrantica">
    <div style="text-align:right;">
        <h5 id="s-title"></h5>
        <p id="s-desc"></p>
    </div>
    <button class="open-frag-btn" onclick="toggleGateway(true)" id="s-btn"></button>
</div>

<div id="gateway-modal">
    <div class="gateway-card">
        <div id="content-ar" style="display:none;">
            <h2 style="color:var(--gold); margin-bottom:15px;">الأعلى تقييماً عالمياً</h2>
            <p style="margin-bottom:20px; line-height:1.6;">اكتشف لماذا تُعد <b>MAD</b> الدار الأكبر في موسوعة <b>Fragrantica</b>.</p>
            <div class="gateway-stars">★★★★★</div>
            <button class="gateway-btn btn-enter-modal" onclick="openFragranticaDirect()">استكشف عطورنا الأصلية</button>
            <button class="gateway-btn" style="background:#eee;" onclick="toggleGateway(false)">العودة</button>
        </div>

        <div id="content-he" style="display:none;">
            <h2 style="color:var(--gold); margin-bottom:15px;">המותג המדורג ביותר בעולם</h2>
            <p style="margin-bottom:20px; line-height:1.6;">גלו למה <b>MAD</b> היא החברה המובילה ב-<b>Fragrantica</b>.</p>
            <div class="gateway-stars">★★★★★</div>
            <button class="gateway-btn btn-enter-modal" onclick="openFragranticaDirect()">לצפייה בבשמים המקוריים</button>
            <button class="gateway-btn" style="background:#eee;" onclick="toggleGateway(false)">חזרה</button>
        </div>
    </div>
</div>

<script>
    const userLang = navigator.language.startsWith("he") ? "he" : "ar";
    const CORPORATE_WA = "0509787730";
    document.documentElement.lang = userLang;
    document.documentElement.dir = "rtl";

    const t = {
        ar: { 
            cs:"خدمة الزبائن", wa:"واتساب الشركة", shop:"الطلب أونلاين", agent:"وكيل جديد",
            open:"مفتوح الآن", closed:"مغلق حالياً", enter:"دخول الفرع", wa_btn:"واتساب", 
            s_h:"MAD: الصدارة العالمية", s_p:"أكبر دار نيش تقييماً في Fragrantica", s_b:"استكشف",
            agent_msg: "أرغب في الحصول على تفاصيل حول الانضمام كوكيل جديد لـ MAD"
        },
        he: { 
            cs:"שירות לקוחות", wa:"וואטסאפ חברה", shop:"הזמנה אונליין", agent:"סוכן חדש",
            open:"פתוח עכשيو", closed:"סגור כעת", enter:"כניסה לסניף", wa_btn:"וואטסאפ", 
            s_h:"MAD: המובילה בעולם", s_p:"המותג המדורג ביותר ב-Fragrantica", s_b:"גלה עכשיו",
            agent_msg: "אני מעוניין לקבל פרטים על הצטרפות כסוכן חדש של MAD"
        }
    }[userLang];

    document.getElementById('s-title').textContent = t.s_h;
    document.getElementById('s-desc').textContent = t.s_p;
    document.getElementById('s-btn').textContent = t.s_b;
    document.querySelector('.l-cs').textContent = t.cs;
    document.querySelector('.l-wa').textContent = t.wa;
    document.querySelector('.l-shop').textContent = t.shop;
    document.querySelector('.l-agent').textContent = t.agent;
    document.getElementById(`content-${userLang}`).style.display = 'block';

    function buildWaUrl(phone, msg = "") {
        let p = phone.replace(/\D/g, ''); 
        if (p.startsWith('0')) p = '972' + p.substring(1);
        return `https://api.whatsapp.com/send/?phone=${p}${msg ? '&text=' + encodeURIComponent(msg) : ''}`;
    }

    document.getElementById('wa-corp-btn').href = buildWaUrl(CORPORATE_WA);
    document.getElementById('new-agent-btn').href = buildWaUrl(CORPORATE_WA, t.agent_msg);
    document.getElementById('online-btn').href = (userLang === "he") ? "https://madperfume.co.il" : "https://madperfume.ps";

    function toggleGateway(show) {
        document.getElementById('gateway-modal').style.display = show ? 'flex' : 'none';
        document.body.style.overflow = show ? 'hidden' : 'auto';
    }

    function openFragranticaDirect() {
        const url = (userLang === "he") ? "https://www.fragrantica.co.il/designers/Mad-Parfumeur.html" : "https://www.fragranticarabia.com/designers/Mad-Parfumeur.html";
        window.open(url, '_blank');
    }

    function isBranchOpen(b) {
        const now = new Date();
        const days = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];
        const today = days[now.getDay()];
        const currentTime = now.getHours() * 60 + now.getMinutes();
        if (!b.schedule || !b.schedule[today]) return false;
        return b.schedule[today].some(r => {
            const [sH, sM] = r[0].split(':').map(Number);
            const [eH, eM] = r[1].split(':').map(Number);
            return currentTime >= (sH * 60 + sM) && currentTime < (eH * 60 + eM);
        });
    }

    async function init() {
        const container = document.getElementById('branchesList');
        try {
            const res = await fetch('branches.json?v=' + Date.now());
            const data = await res.json();
            let html = '';
            data.branches.forEach(b => {
                const open = isBranchOpen(b);
                html += `
                    <div class="branch-card">
                        <div class="br-header">
                            <div class="br-title">${b[`name_${userLang}`]}</div>
                            <div class="status-pill" style="border: 1px solid ${open ? 'var(--wa-green)' : '#ff4d4d'}; color:${open ? 'var(--wa-green)' : '#ff4d4d'}">
                                ● ${open ? t.open : t.closed}
                            </div>
                        </div>
                        <div class="btn-group">
                            <a href="${buildWaUrl(b.phone)}" class="btn bg-wa"><i class="fab fa-whatsapp"></i>${t.wa_btn}</a>
                            <a href="https://ul.waze.com/ul?ll=${b.lat},${b.lng}&navigate=yes" target="_blank" class="btn bg-waze"><i class="fab fa-waze"></i>Waze</a>
                            <a href="offer.html?branch=${b.id}" class="btn bg-enter"><i class="fas fa-gift"></i>${t.enter}</a>
                        </div>
                    </div>`;
            });
            container.innerHTML = html;
        } catch(e) { container.innerHTML = 'Error loading branches.'; }
    }
    init();
</script>
</body>
</html>
